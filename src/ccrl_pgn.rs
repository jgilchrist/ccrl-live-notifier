use crate::ccrllive::CcrlLivePlayer;
use anyhow::{bail, Result};
use pgn_reader::{BufferedReader, RawComment, RawHeader, SanPlus, Skip, Visitor};
use std::hash::{Hash, Hasher};

const WHITE_HEADER_KEY: &str = "White";
const BLACK_HEADER_KEY: &str = "Black";
const DATE_HEADER_KEY: &str = "Date";
const BOOK_MOVE_COMMENT_VALUE: &str = "(Book)";

#[derive(Debug, Clone)]
pub struct Pgn {
    pub white_player: CcrlLivePlayer,
    pub black_player: CcrlLivePlayer,
    pub date: String,

    pub moves: Vec<(String, bool)>,
}

impl Pgn {
    /// The game is 'out of book' if any of the moves that were played are not book moves
    pub fn out_of_book(&self) -> bool {
        self.moves.iter().any(|(_, in_book)| !in_book)
    }

    pub fn as_hash(&self) -> u64 {
        let mut hasher = std::hash::DefaultHasher::new();
        self.hash(&mut hasher);
        hasher.finish()
    }

    pub fn has_player(&self, player: &str) -> bool {
        self.white_player_is(player) || self.black_player_is(player)
    }

    fn white_player_is(&self, player: &str) -> bool {
        self.white_player.matches(player)
    }

    fn black_player_is(&self, player: &str) -> bool {
        self.black_player.matches(player)
    }
}

// The hash of a CCRL PGN is the hash of the players, the date, and the book.
// That is to say, we consider games equivalent if they are played by the same players
// on the same day, with the same opening book.
// FIXME: This doesn't account for replays.
impl Hash for Pgn {
    fn hash<H: Hasher>(&self, state: &mut H) {
        self.white_player.hash(state);
        self.black_player.hash(state);
        self.date.hash(state);

        let book_moves = self.moves.iter().take_while(|(_, in_book)| *in_book);

        for (mv, _) in book_moves {
            mv.hash(state);
        }
    }
}

impl PartialEq<Self> for Pgn {
    fn eq(&self, other: &Self) -> bool {
        self.as_hash() == other.as_hash()
    }
}

impl Eq for Pgn {}

struct PgnInfoBuilder {
    pub white_player: Option<String>,
    pub black_player: Option<String>,
    pub date: Option<String>,
    pub moves: Vec<(String, bool)>,

    pub last_san: Option<String>,
}

impl PgnInfoBuilder {
    pub fn new() -> PgnInfoBuilder {
        Self {
            white_player: None,
            black_player: None,
            date: None,
            moves: vec![],

            last_san: None,
        }
    }
}

impl Visitor for PgnInfoBuilder {
    type Result = Pgn;

    fn header(&mut self, key: &[u8], value: RawHeader<'_>) {
        let key = String::from_utf8_lossy(key);
        let value = value.decode_utf8_lossy();

        if key == WHITE_HEADER_KEY {
            self.white_player = Some(value.to_string());
        }

        if key == BLACK_HEADER_KEY {
            self.black_player = Some(value.to_string());
        }

        if key == DATE_HEADER_KEY {
            self.date = Some(value.to_string());
        }
    }

    fn san(&mut self, san: SanPlus) {
        assert_eq!(self.last_san, None);

        self.last_san = Some(san.to_string());
    }

    fn comment(&mut self, comment: RawComment<'_>) {
        let Some(san) = self.last_san.clone() else {
            panic!("Saw PGN comment without preceding SAN");
        };

        let comment = String::from_utf8_lossy(comment.as_bytes()).to_string();
        let is_book_move = comment == BOOK_MOVE_COMMENT_VALUE;

        self.moves.push((san, is_book_move));
        self.last_san = None;
    }

    fn begin_variation(&mut self) -> Skip {
        Skip(true)
    }

    fn end_game(&mut self) -> Self::Result {
        assert_ne!(self.white_player, None);
        assert_ne!(self.black_player, None);
        assert_ne!(self.date, None);

        Pgn {
            white_player: CcrlLivePlayer::new(self.white_player.clone().unwrap()),
            black_player: CcrlLivePlayer::new(self.black_player.clone().unwrap()),
            date: self.date.clone().unwrap(),
            moves: self.moves.clone(),
        }
    }
}

pub fn get_pgn_info(pgn: &str) -> Result<Pgn> {
    let mut reader = BufferedReader::new_cursor(pgn);

    let pgn_info = reader.read_game(&mut PgnInfoBuilder::new())?;

    let Some(pgn_info) = pgn_info else {
        bail!("Empty PGN")
    };

    Ok(pgn_info)
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_pgn_parsing_grabs_correct_information() {
        let sample_pgn = r#"[Site "114th Amateur D11"]
[Date "2025.01.06"]
[White "RookieMonster 1.9.9 64-bit"]
[Black "Betsabe_II 2023"]

1. d4 {(Book)} Nf6 {(Book)} 2. c4 {(Book)} g6 {(Book)} 3. Nf3 {(Book)} Bg7 {(Book)} 4. Nc3 {(Book)} d5 {(Book)} 5. Qa4+ {(Book)} Bd7 {(Book)} 6. Qb3 {(Book)} dxc4 {(Book)} 7. Qxc4 {(Book)} O-O {(Book)} 8. Bf4 {(Book)} Na6 {(Book)} 9. e4 {(e4 c5 d5 b5 Nxb5 Nxe4 Qxe4 Bxb5 O-O-O Qa5 Bxb5 Qxb5 Be5 Bxe5 Nxe5 Rab8 Nc4 Nb4) -0.41/18 1736170414} c5 {(c5) -0.57/17 38} 10. Be2 {(Be2 cxd4 Qxd4 Bc6 O-O Nxe4 Qe3 Nxc3 bxc3 Qa5 Ne5 Nc5 Rad1 Rac8 Bc4 Be4 Rfe1) -0.39/17 33} cxd4 {(cxd4 Qxd4 Bc6 e5 Nh5 Qxd8 Raxd8 Bg5 f6 exf6 Bxf6 Bh6) 0.22/17 22} 11. Qxd4 {(Qxd4 Bc6 e5 Nh5 Be3 Qxd4 Nxd4 Bxg2 Rg1 Bh3 O-O-O Nc5 Bxh5 gxh5 Kb1 Rad8 Rg5 Ne6 Rxh5 Nxd4) -0.68/20 28} Bc6 {(Bc6) 0.35/18 27} 12. e5 {(e5 Nh5 Be3 Qxd4 Nxd4 Bxg2 Rg1 Bh3 Bxh5 gxh5 Bh6 Bg4 Nf5 Bxe5 Nxe7+ Kh8 Bxf8 Rxf8 h3 Bxh3) -0.26/19 20} Ng4 {(Ng4 O-O-O Qc7 Bg3 Bxf3 Bxf3 Nxe5 Qe3 e6 Rhe1 f6 Rd2) 0.13/18 17} 13. Rd1 {(Rd1 Bxf3 Bxf3 Qxd4 Rxd4 Nxe5 Bxe5 Bxe5 Rc4 Bxc3+ bxc3 Rfd8 O-O Rab8 Re1 e6 a3 Rd2 Rd4 Rxd4 cxd4 Nc7) -0.71/21 36} Qa5 {(Qa5 Bg3 Bxf3 Bxf3 Nxe5 Bxe5 Bxe5 Qe3 Bxc3+ bxc3 Nc5 O-O) 0.64/19 32} 14. O-O {(O-O e6 Ne4 Rad8 Nd6 Bxf3 Bxf3 Nxe5 Qe3 Nxf3+ Qxf3 Qb4 Nxb7 Rxd1 Rxd1 Qxb2 Nd6 Nc5) -0.30/17 19} e6 {(e6 Qd6 Rfd8 Qe7 Rxd1 Rxd1 Qb6 Nd4 Rd8 Qxd8+ Qxd8 Nxc6) 0.17/18 50} 15. Qd6 {(Qd6 Bxf3 Bxf3 Rad8 Qe7 Nxe5 Bxb7 Nb4 Be4 Nbc6 Qg5 Qb6 Na4 Qb4 Bxe5 Qxe4 Bxg7) -0.04/17 34} Rad8 {(Rad8) 0.02/17 21} 16. Qe7 {(Qe7 Bxf3 Bxf3 Nxe5 Bxb7 Nb4 Be4 Nbc6) -0.04/15 18} Qb6 {(Qb6) 0.32/17 16} 17. Rxd8 {(Rxd8 Qxd8 Qd6 Qb6 h3 Rd8 Qe7 Re8 Qg5 Qxb2 Bxa6 Qxc3 Rc1 Qa5 Rxc6 bxc6 Bb7 Qb6) 0.07/18 18} Qxd8 {(Qxd8 Qxd8 Rxd8 Bxa6 bxa6 Re1 Bf8 h3 Nh6 Bg5 Rd3 Rd1) 0.27/20 21} 18. Qd6 {(Qd6 Qb6 h3 Rd8 Qe7 Re8 Qd6 Rd8) 0.02/19 18} Qb6 {(Qb6) 0.36/19 15} 19. h3 {(h3 Rd8 Qe7 Re8 Qd6 Rd8) 0.02/18 18} Rd8 {(Rd8) 0.24/19 15} 20. Qe7 {(Qe7 Re8 Qd6 Rd8) 0.02/20 17} Rd7 {(Rd7) 0.56/19 26} 21. Qa3 {(Qa3 Bxf3 hxg4 Bxe2 Nxe2 Bf8 Qc3 Bc5 Bg5 Nb4 Nc1 h6 Bd2 g5 Nb3 Nxa2 Qc4 Nb4 Bxb4 Bxb4) -1.53/20 26} Bxf3 {(Bxf3) 0.63/20 18} 22. hxg4 {(hxg4 Bxe2 Nxe2 Bf8 Qc3 Nb4 Be3 Nxa2 Qc2 Qc7 Qe4 Nb4 Ra1 Qc6 Ng3 a6 Rc1 Qxe4 Nxe4 Nd5 Bg5 h6 Bf6) -1.56/23 33} Bxe2 {(Bxe2 Nxe2 Bf8 Qc3 Nc7 Be3 Qa6 Nc1 Nd5 Qd4 Nxe3 Qxe3) 0.99/19 21} 23. Nxe2 {(Nxe2 Bf8 Qc3 Nb4 Bg5 Rc7 Qf3 Nc6 Qc3 Qb5 Re1 Qxe5 Qd2 Qd6 Qxd6 Bxd6 Nc3 Be5 Nb5 Rd7 Nxa7 Bxb2 Nxc6) -1.68/23 26} Bf8 {(Bf8) 0.99/19 13} 24. Qc3 {(Qc3 Nb4 Bg5 Rc7 Qf3 Nc6 Qc3 Qb5 Qc2 Qa5 Bf6 Nxe5 Qe4 Bg7 Bxg7 Kxg7 Rd1 Nd7 Nc3 Qc5 Qf4 g5) -1.77/22 31} Nc7 {(Nc7 Be3 Qa6 Nf4 Qxa2 Rc1 Qa6 b3 Bg7 g5 Qb5 Bd4) 0.92/18 19} 25. Be3 {(Be3 Qb5 Nf4 Bg7 Bc5 b6 Bd4 Qa4 Ne2 Qxa2 g5 Bf8 Qc6 Qd5 Qc2 Bg7 f4 Nb5 Rd1 Rc7) -1.37/20 30} Qb5 {(Qb5) 0.85/21 38} 26. Qc2 {(Qc2 Qxe5 Bxa7 Qa5 Bb8 Bg7 g5 Be5 Nc3 Rd8 Bxc7 Qxc7 Rd1 Rxd1+ Qxd1 Bxc3 bxc3 Qxc3 Qd8+ Kg7 Kh2 b5 g3) -1.34/21 29} Qxe5 {(Qxe5) 0.89/19 18} 27. Bxa7 {(Bxa7 Qa5 Bb8 Bg7 g5 Rd2 Qc4 Be5 Rc1) -1.24/20 38} Qa5 {(Qa5) 1.01/19 24} 28. Bb8 {(Bb8 Bg7 g5 Rd2 Qc4) -1.24/18 27} Rd2 {(Rd2 Bxc7 Qd5 Qb3 Qxb3 axb3 Rxe2 Rd1 Bc5 b4 Be7 Kf1) 0.81/18 19} 29. Qc3 {(Qc3 Bb4 Qxc7 Qxc7 Bxc7 Rxe2 Rc1 Rxb2 Be5 Rd2 Rb1 Bc5 Rxb7 Bxf2+ Kh2 Bc5 Rb8+ Bf8 a4 Rd5 Bc3 Rc5 Bf6) -1.08/21 17} Bb4 {(Bb4) 0.85/20 20} 30. Qxc7 {(Qxc7 Qxc7 Bxc7 Rxe2 Rc1 Bf8 Bg3 Rxb2 Rc8 Rd2 Rb8 b6 Rxb6 Rxa2 Rb8 Rd2 Kh2 h6 f3 Rd5 Rb7 Rd2) -0.87/22 17} Qxc7 {(Qxc7 Bxc7 Rxe2 Rc1 Bf8 Bf4 e5 Be3 Rxb2 a4 Ra2 Rc8) 0.80/20 17} 31. Bxc7 {(Bxc7 Rxe2 Rc1 Bf8 Bg3 Rxb2 Rc8 Rb6 Kh2 f6 a4 Ra6 Rb8 g5 Rxb7 Rxa4 Rb6 Re4 Rc6 Re2 Rb6 Re1 Rb7) -0.63/23 17} Rxe2 {(Rxe2 Rc1 Bf8 Bf4 e5 Bg3 Rxb2 Bxe5 Re2 Bf6 Rxa2 Rb1) 0.81/19 26} 32. Rc1 {(Rc1 Bf8 Bg3 Rxb2 Rc8 Rb6 Kh2 f6 a4 Kg7 Rc7+ Kh8 Rf7 Bg7 Rd7 h6 f3 Rb4 a5 Kh7 Re7 Rb5 Rxe6 Rxa5) -0.39/23 16} Bf8 {(Bf8) 0.68/19 22} 33. Bg3 {(Bg3 Rxb2 Rc8 Rb6 g5 Rb1+ Kh2 Rd1 Be5 b6 Rb8 Rd5 Bf6 Rd7 f3 Ra7 Rxb6 Rxa2 Rb8 Rc2 Rd8 Rc1 Rd7) 0.01/23 16} f6 {(f6) 0.59/18 18} 34. Rc8 {(Rc8 e5 b3 Rxa2 Rb8 h6 Rxb7 Rb2 Kh2 Bc5 f3 Rb1 Bh4 f5 gxf5 gxf5 Bf6 e4 fxe4 fxe4 Be5 h5) -0.12/22 16} e5 {(e5) 0.50/20 17} 35. b4 {(b4 Rxa2 Rb8 Kf7 Rxb7+ Ke6 b5 Rb2 Kh2 h6 Kh3 Bc5 f3 Bd4 Rb8 Rb1 Kh2 Bg1+) -0.11/21 16} Rxa2 {(Rxa2 Rb8 Kf7 Rxb7+ Ke6 b5 Rb2 Kh2 Bc5 f3 h6 Kh3) 0.54/20 21} 36. Rb8 {(Rb8 Kf7 Rxb7+ Ke6 b5 Rb2 Kh2 h6 Rb6+ Bd6 Rb7 Bc5 f3 Bd4 Rb8 f5 gxf5+ gxf5 Kh3 h5 Bh4 Rb1 Re8+ Kd5 Rd8+ Kc5) -0.11/21 15} Kf7 {(Kf7) 0.54/19 15} 37. Rxb7+ {(Rxb7+ Ke6 b5 Rb2 Kh2 h6 f3 Bc5 Rb8 Rb1 Re8+ Kf7 Rb8 Be3 Bh4 Rb2 Be1 Ke6) -0.12/21 15} Ke6 {(Ke6) 0.54/19 21} 38. b5 {(b5 Rb2 Kh2 h6 f3 Bc5 Rb8 Rb1 Re8+ Kf7 Rb8 Be3 Bh4 Bg1+ Kh3 Bc5 Rb7+ Ke6 Kh2 Bg1+ Kh3 Bd4 Rb8) -0.18/22 15} Rb2 {(Rb2) 0.57/19 20} 39. Rxh7 {(Rxh7 Rxb5) -0.11/17 15} Rxb5 {(Rxb5 Kh2 Bc5 Rh8 Bd4 Re8+ Kf7 Rc8 Rc5 Rxc5 Bxc5 f3) 0.98/18 13} 40. Kh2 {(Kh2 Rb2) -0.15/16 15} f5 {(f5 Rh8 Kf7 gxf5 gxf5 f3 e4 Bf4 Rb2 fxe4 fxe4 Rh5) 0.94/17 18} 41. Rh8 {(Rh8 Bg7 gxf5+ gxf5 Re8+ Kf7 Rc8 Bf6 Rc7+ Ke6 Rc6+ Ke7 f3 Rb2 Kh3 Kf7 Rc5 Ke6 Rc6+ Ke7 Kh2 Ra2 Rc5) -0.22/19 15} Bg7 {(Bg7) 0.93/19 28} 42. gxf5+ {(gxf5+ gxf5 Re8+ Kf7 Rc8 Bf6 Rc7+ Ke6 Rc6+ Ke7 f3 Rb2 Kh3 Rb1 Kh2 Kf7 Ra6 Rb2 Ra5) -0.23/19 14} gxf5 {(gxf5 Re8+ Kd5 Rd8+ Kc4 Rd7 Bf6 Rd6 Bg5 Kh3 e4 Rc6+) 0.88/17 11} 43. Re8+ {(Re8+ Kf7 Rc8 Bf6) -0.23/19 14} Kf7 {(Kf7) 0.94/18 12} 44. Rc8 {(Rc8 Bf6) -0.19/19 14} Bf8 {(Bf8) 0.89/17 16} 45. Rc6 {(Rc6 Be7 f3 e4 Rc7 Ke6 Bf4 Rb2 Kg1 Ra2 fxe4 fxe4 g4 Ra3 Rc8 e3) -0.45/18 14} Rd5 {(Rd5 Bh4 Bd6 g3 Rd2 Kg2 Ke6 Bg5 Rd3 Kh3 Kd5 Rc2) 0.93/18 19} 46. Bh4 {(Bh4 Bd6 Bg5 Kg7 g3 f4 gxf4 exf4 Rxd6 Rxd6 Bxf4) 0.00/20 14} Bd6 {(Bd6) 0.79/18 13} 47. Bg5 {(Bg5 Kg7 g3 f4 gxf4 exf4 Rxd6 Rxd6 Bxf4) 0.00/20 14} e4+ {(e4+) 0.69/17 10} 48. g3 {(g3 Be5 Be3 Rb5 Ra6 Rb2 Kh3 Rb1 Ra5 Ke6 Ra8 Kf7 Kg2 Ke6 Ra6+ Kd5 Ra5+ Kd6 Kh2 Ke6 Ra7 Rb2 Kh3 Bf6) 0.03/22 14} Be5 {(Be5) 0.78/18 10} 49. Be3 {(Be3 Rb5 Ra6 Rb2 Kh3 Rb1 Ra5 Ke6 Ra8 Rh1+ Kg2 Rb1 Ra6+ Kf7 Ra8 Ke6) 0.03/22 13} Rd8 {(Rd8) 0.50/18 13} 50. Kg2 {(Kg2 Rd1 Ra6 Rb1 Ra7+ Kf6 Ra5 Rb2 Ra6+ Kf7 Kh3 Rb1) 0.07/22 13} Ra8 {(Ra8 Kh3 Ke7 Kh4 Rg8 Ra6 Bd6 Bd4 Kd7 Kh3 Rg4 Kg2) 0.56/18 19} 51. Kg1 {(Kg1 Ra2 Kh2 Rb2 Kg2 Kg7 Ra6 Kf7 Ra7+ Kg6 Kh2) 0.07/21 13} Ke7 {(Ke7) 0.66/17 15} 52. Rc5 {(Rc5 Ke6 Kg2 Ra2 Rb5 Rb2 Ra5 Kf6 Ra6+) 0.07/22 13} Kd6 {(Kd6 Kg2 Rg8 Ra5 f4 Ra6+ Kd5 Ra5+ Ke6 Rxe5+ Kxe5 Bxf4+) 0.51/19 9} 53. Rb5 {(Rb5 Ra1+ Kg2 Ke6 Bc5 Ra2 Be3 Rb2) 0.07/22 13} Ra3 {(Rg8 Rb6+ Kd5 Rb5+ Ke6 Rb6+ Ke7 Rb5 Kf6 Rb6+ Kf7 Rb5) 0.07/18 29} 54. Kh2 {(Kh2 Ra1 Kg2 Ke6) 0.07/23 13} Ra6 {(Ra6 Kh3 Ra8 Rb6+ Kd5 Rb5+ Ke6 Rb6+ Kf7 Rb7+ Kf6 Rb6+) 0.10/19 11} 55. Kh3 {(Kh3 Ke6 Kg2 Ra2 Rb6+ Kd5 Rb7 Ke6 Rb5 Rb2) 0.07/22 13} Ke6 {(Ke6) 0.01/19 16} 56. Kg2 {(Kg2 Ra2 Rb6+ Kd5 Rb7 Ke6 Rb5 Bc3 Rb6+ Kf7 Rb7+ Kg6 Rb8 Rb2 Rg8+ Kf7 Rc8 Be5 Rc6 Kg7) 0.07/23 13} Bd6 {(Bd6) 0.26/18 10} 57. Rb7 {(Rb7 Be5 Kh2 Ra2 Rb6+ Kf7 Kg2 Bc3 Rb7+ Kg6 Rb8 Rb2 Rg8+ Kf7 Rc8 Be5 Rc6 Rb1 Ra6 Rb2 Ra7+) 0.07/23 12} Ra5 {(Ra5) 0.35/19 9} 58. Rb2 {(Rb2 Bc5 Bd2 Ra1 Rc2 Kd5 Bh6 Ra4 Bg5 Ra1 Bc1 Ra4) 0.03/18 12} Rd5 {(Rd5 Rb6 Ke7 Kh3 Rd3 Kh4 Rd1 Kh3 Kf7 g4 f4 Rxd6) 0.51/18 14} 59. Rb6 {(Rb6 Ke7 Rb1 Ke6 Rh1 Be5 Rh7 Rd1 Rh6+ Kf7 Ra6 Rb1) 0.07/22 12} Ke7 {(Ke7 Rb7+ Kf6 Rb6 Kf7 Rb7+ Kg6 Rb6 Kh5 f3 Rd3 fxe4) 0.17/19 10} 60. Rb1 {(Rb1 Ke6) 0.07/21 12} Rd3 {(Rd3 Kh3 Kf7 Kh4 Be7+ Kh3 Kg6 Rb6+ Rd6 Rb4 Rc6 Rb7) 0.32/18 10} 61. Ra1 {(Ra1 Be5 Ra7+ Kf6 Ra6+ Kf7 Kh2 Rd1 Kg2 Rb1) 0.07/20 12} Ke6 {(Ke6 Rb1 Be5 Rb6+ Rd6 Rxd6+ Bxd6 Kh3 Kf6 Bf4 Bc5 Be3) 0.40/17 8} 62. Ra6 {(Ra6 Kf7 Ra7+ Ke6 Rb7 Kd5) 0.07/21 12} Kf7 {(Kf7 Ra7+ Kg6 Ra6 Kg7 Ra7+ Kf6 Ra6 Rd5 f3 Ke6 Bf4) 0.07/20 9} 63. Ra7+ {(Ra7+ Ke6 Rb7 Rd5 Bg5 Ra5 Rb6 Kd5 Bd2 Ra2 Be3 Be5 Rb7) 0.07/22 12} Kf6 {(Kf6) 0.00/23 8} 64. Rb7 {(Rb7 Rd1 Kh2 Be5 Rb6+ Kf7 Rb5 Kf6 Ra5 Bd6 Kh3 Rd3 Kg2 Be5 Ra6+ Kf7) 0.07/22 12} Be5 {(Be5) 0.12/19 18} 65. Rb6+ {(Rb6+ Kf7 Rc6 Rd1 Ra6) 0.07/18 12} Ke7 {(Ke7) 0.12/19 8} 66. Bg5+ {(Bg5+ Kf7 Rb5 Ke6 Be3 Kf6 Rb4 Kg6 Rb6+ Kf7 Rc6) 0.07/18 12} Kd7 {(Kf7 Be3 Rc3 g4 fxg4 Rb4 Ke6 Rxe4 Kf5 Rb4 Rc2 Bd4) 0.38/18 8} 67. Ra6 {(Ra6 Bd6 Be3 Ke6 Rb6 Kf7 Rb7+) 0.07/20 12} Rf3 {(Rf3) 0.72/18 10} 68. Bf6 {(Bf6 Bd6 Ra5 Ke6 Bd4 Rd3 Be3 Be5 Ra6+ Kf7) 0.07/21 11} Bc7 {(Bc7 Bd4 Bd6 Ra4 Kc6 Ra5 Bc7 Rc5+ Kd6 Rc2 Kd5 Rxc7) 0.50/18 10} 69. Bg7 {(Bg7 Bd6 Ra5 Ke6 Bd4 Rd3) 0.07/19 11} Bb8 {(Bb8) 0.50/18 10} 70. Rb6 {(Rb6 Bd6) 0.07/19 11} Bd6 {(Bd6) 0.70/20 9} 71. Bd4 {(Bd4 Rd3 Be3 Ke6) 0.07/18 11} Ra3 {(Ra3 Be3 Ra4 Rb7+ Ke6 Ra7 Rxa7 Bxa7 Ke5 f3 Kd5 Kf2) 0.40/19 10} 72. Be3 {(Be3 Rd3 Rb5 Ke6 Bg5 Rd1 Rb6 Kf7 Ra6 Be5 Ra7+ Kg6 Be3 Rd3 Ra6+ Kf7 Ra7+) 0.07/22 11} Ra2 {(Ra2) 0.50/18 12} 73. Kh3 {(Kh3 Ra5 Kh2 Ra3 Rb7+ Ke6 Rb2 Kd5 Rb5+ Ke6 Rb1 Be5 Rb6+ Kf7 Rb7+ Ke6 Kg2 Ra2 Rb6+ Kd5) 0.07/18 11} Ra5 {(Ra5 Kh4 Rd5 g4 f4 Rxd6+ Kxd6 Bxf4+ Ke6 Be3 Ke5 Kg5) 0.31/18 12} 74. Rb2 {(Rb2 Ke6 Rc2 Ra1 Kg2 Rb1 Rc6 Kd7 Ra6 Be5 Ra7+ Ke6 Kh2 Kd5 Ra5+ Ke6 Kg2 Kf6 Ra6+ Kf7 Ra7+ Kf6) 0.07/21 11} Rd5 {(Rd5 Rc2 Rd3 Kh4 Ke6 Bf4 Bxf4 gxf4 Kd6 Kg5 Rd5 Kf6) 0.44/17 9} 75. Ra2 {(Ra2 Ke6 Ra6 Kf7 Ra7+ Kg6 Kg2) 0.07/16 11} Ke7 {(Ke7 Ra4 Kf6 Bd4+ Kg5 Rc4 Be7 Be3+ Kh5 g4+ fxg4+ Kg3) 0.42/17 10} 76. Ra7+ {(Ra7+ Kf6 Ra6 Kf7 Ra1) 0.07/15 11} Kf6 {(Kf6 Ra6 Kf7 Kh4 Be7+ Bg5 Bc5 Be3 Bxe3 fxe3 Rd3 Kg5) 0.00/20 21} 77. Ra6 {(Ra6 Kf7 Ra1 Rd3 Ra7+ Kf6 Kg2 Kg6 Ra1 Be5 Ra6+ Kf7 Ra7+) 0.07/22 11} Ke6 {(Ke6) 0.00/20 7} 78. Bf4 {(Bf4 Ke7 Bg5+ Kf7 Kg2 Be5 Ra7+ Kg6 Be3 Rd3 Ra6+ Kf7) 0.07/21 11} Rd3 {(Rd3) 0.00/22 10} 79. Kh4 {(Kh4 Ke7 Bg5+ Ke8 Ra8+ Kf7 Be3 Rd5 Kh3 Rd1 Kh2 Be5 Ra7+ Kf6 Ra6+ Kf7 Kg2) 0.07/19 11} Ke7 {(Ke7) 0.00/21 8} 80. Bg5+ {(Bg5+ Ke8 Ra8+ Kf7) 0.07/18 11} Kd7 {(Kd7 Be3 Rd5 Ra4 Be7+ Kh3 Rd3 Kg2 Ke6 g4 Bd6 Kf1) 0.09/17 7}"#;

        let pgn_info = get_pgn_info(sample_pgn).unwrap();

        assert!(pgn_info.white_player.matches("RookieMonster 1.9.9"));
        assert!(pgn_info.black_player.matches("Betsabe_II 2023"));
        assert_eq!(pgn_info.date, "2025.01.06");
        assert!(pgn_info.out_of_book())
    }

    #[test]
    fn test_pgn_parsing_in_book_returns_true() {
        let sample_pgn = r#"[Site "114th Amateur D11"]
[Date "2025.01.06"]
[White "RookieMonster 1.9.9 64-bit"]
[Black "Betsabe_II 2023"]

1. d4 {(Book)} Nf6 {(Book)} 2. c4 {(Book)}"#;

        let pgn_info = get_pgn_info(sample_pgn).unwrap();
        assert!(!pgn_info.out_of_book())
    }

    #[test]
    fn test_pgn_with_no_moves_is_in_book() {
        let sample_pgn = r#"[Site "114th Amateur D11"]
[Date "2025.01.06"]
[White "RookieMonster 1.9.9 64-bit"]
[Black "Betsabe_II 2023"]
"#;

        let pgn_info = get_pgn_info(sample_pgn).unwrap();
        assert!(!pgn_info.out_of_book())
}

    #[test]
    fn test_pgn_with_wrong_book_moves() {
        let full_pgn = r#"[Site "Zangdar Gauntlet"]
[Date "2025.02.16"]
[White "Nalwald 19"]
[Black "Zangdar 3.04"]
[Result "1/2-1/2"]

1. e4 {(Book)} e5 {(Book)} 2. Nf3 {(Book)} Nc6 {(Book)} 3. Bb5 {(Book)} a6 {(Book)} 4. Ba4 {(Book)} d6 {(Book)} 5. c3 {(Book)} f5 {(Book)} 6. exf5 {(Book)} Bxf5 {(Book)} 7. d4 {(Book)} e4 {(Book)} 8. Nfd2 {(Book)} Nf6 {(Book)} 9. f3 {(f3 exf3 O-O Be7 Nxf3 O-O Nbd2 h6 Qb3+ d5 Bxc6 bxc6 Ne5 Qc8 Nxc6 Bd6 Nf3) 0.10/23 10} d5 {(d5) 0.02/32 65} 10. O-O {(O-O Qd7 Qe1 Bd6 fxe4 dxe4 Nc4 b5 Nxd6+ cxd6 Bb3 d5 Qf2 Bg6 Nd2 O-O Bc2) 0.02/23 10} Qd7 {(Qd7) 0.05/33 22} 11. fxe4 {(fxe4 dxe4 Bxc6 bxc6 Nc4 Bd6 Bf4 Bxf4 Rxf4 Nd5 Ne5 Qe6 Rh4 O-O Nd2 e3 Ndf3 c5 Ng5 Qe7 Qe2 Qxg5 dxc5) 0.17/27 24} dxe4 {(dxe4 Qe1 Bd6 Nc4 b5 Nxd6+ cxd6 Bd1 O-O Na3 h6 Nc2 Bg4 a4 Bxd1 Qxd1 Ne7 axb5 Qxb5 Na3 Qd7 Qe2 Nf5 Nc4 Qe6) 0.14/32 31} 12. Qe1 {(Bc2 O-O-O Nc4 Bg6 Ne3 h5 Nd2 h4 a4 h3 g3 Kb8 Qe1 Bd6 Ndc4 Bh5 Nxd6 Qxd6 b4 Bf3 Rf2 Rdf8) 0.06/28 62} Be7 {(Be7) 0.00/34 25} 13. Nc4 {(Nc4 b5 Ne3 Bg6 Bd1 O-O a4 Rae8 Nd2 Nd8 b4 Ne6 axb5 axb5 Nb3 c6 Nc5 Nxc5 bxc5 Kh8 Bb3 Nh5 Bc2 Rxf1+ Nxf1) 0.00/29 13} b5 {(b5 Ne3 Bg6 Bb3 Na5 Bd1 O-O b4 Nb7 a4 Bd6 axb5 axb5 Rxa8 Rxa8 Nd2 c6 Nb3 Bc7 Qh4 Rf8 Bc2 Re8 Bd1 h6) 0.18/37 22} 14. Ne3 {(Ne3 Bg6 Bd1 O-O a4 Rae8 axb5 axb5 Be2 Nd8 Ra7 Nf7 Na3 Nd6 Qg3 Bd8 Qh3 Qxh3 gxh3 Bh5 Ng4 Nd5 Nxb5 Rxf1+ Kxf1) 0.14/32 16} Bg6 {(Bg6 Bb3 Na5 Bd1 O-O b4 Nb7 a4 c6 Nd2 a5 bxa5 Rxa5 Bb2 Kh8 Kh1 Nd6 c4 Raa8 axb5 Rxa1 Bxa1 cxb5 Be2 bxc4) 0.22/35 17} 15. Bb3 {(Bd1 O-O a4 Bd6 axb5 axb5 Rxa8 Rxa8 Na3 Nd8 Qh4 Nf7 Ng4 Nd5 Bb3 c6 Nc2 Be7 Qg3 Bd6 Bxd5 Bxg3 Nf6+ gxf6) 0.07/31 16} Na5 {(Na5) 0.00/34 18} 16. Bd1 {(Bd1 O-O b4 Nb7 a4 a5 bxa5 Rxa5 Nd2 Raa8 Rb1 c6 axb5 cxb5 Be2 Nd6 Nb3 Qc6 Nc5 Nd5 Nxd5 Rxf1+ Bxf1 Qxd5 h4) 0.01/30 14} O-O {(O-O) 0.00/35 25} 17. b4 {(b4 Nb7 a4 a5 bxa5 Rxa5 Na3 c6 Bb2 Nd5) 0.08/29 20} Nb7 {(Nb7) 0.00/35 24} 18. a4 {(a4 a5 bxa5 Rxa5 Na3 c6 Bb2 Nd5 Rxf8+ Bxf8 Bg4 Qf7 Nxd5 Qxd5 c4 bxc4 Nc2 Bh5 Bxh5 Qxh5 Qxe4 Qf7) 0.04/29 6} c6 {(c6 Nd2 a5 axb5 cxb5 Nb3 a4 Nc5 Nxc5 bxc5 Kh8 Rb1 Bf7 Ra1 Be6 Bc2 Rae8 Kh1 Bg8 Bd2 Rd8 Bc1 Rde8) 0.00/35 82} 19. axb5 {(axb5 axb5 Rxa8 Rxa8 Nd2 Nd6 Nb3 Bf7 Nc5 Qe8 Qg3 Kh8 Bc2 Ra2 Re1 Bd5 Nxd5 cxd5 Bb3 Ra1 Ne6 Nf5 Qe5 Kg8) 0.12/28 16} axb5 {(axb5 Rxa8 Rxa8 Nd2 Kh8 Nb3 Bd6 Qh4 Qe6 Qg5 Bc7 Bd2 Bf7 Nf5 Bg6 Ne3) 0.00/32 31} 20. Rxa8 {(Rxa8 Rxa8 Nd2 Nd6 Nb3 Qe8 Nc5 Bf7 Qg3 Kh8 Bb3 Bxb3 Nxb3 Nd5 Nxd5 cxd5 Nc5 Nc4 Ne6 Qg8 Nc5) 0.03/30 30} Rxa8 {(Rxa8) 0.00/33 12} 21. Nd2 {(Nd2 Qe8 Nb3 Bf7 Qg3 Bd6 Qg5 h6 Qh4 Nd5 Nf5 Bf8 Qg3 Bg6 Nh4 Nd6 Nxg6 e3) 0.09/29 31} Kh8 {(Kh8) 0.00/34 25} 22. Nb3 {(Nb3 Bf7 Qg3 Nd6 Nc5 Qd8 Bb3 Bxb3 Nxb3 Nd5 Nxd5 cxd5 Nc5 Bf6 Qh3 Ra1 Nd7 Qe7 Nxf6 gxf6 Bf4 h5) 0.12/30 21} Bf7 {(Bf7 h3 Bg8 Qg3 Bd6 Qh4 Bc7 Ng4 Nxg4 hxg4 Bd5 g5 Qe7 Qh3 Be6 Qh4 Nd6 Nc5 Bd5 Qh3 Ra1 g6 h6 Bf4 Nc4) 0.57/28 13} 23. Qg3 {(Qg3 Nd6 Bc2 Qe8 Nc5 h6 Qh3 Ra1 Bb3 Bd5 Qg3 Qf7 Nxd5 cxd5 Qe5 Nc4 Qb8+ Qe8 Qxe8+ Nxe8 Bxc4 bxc4 Bf4 Ra3 Nd7) 0.04/29 13} Bg8 {(Bg8 Kh1 Bd6 Qh4 Nd5 Nxd5 Bxd5 Bg4 Qe8 Bf5 g6 Qf6+ Kg8 Nc5 Nxc5 Qxd6 gxf5 dxc5 Qg6 Kg1 e3 Qxg6+ hxg6 Bxe3 Ra2) 0.70/29 13} 24. Nf5 {(Qg3 Nd6 Bc2 Qe8 Nc5 h6 Bb3 Bxb3 Nxb3 Nd5 Nxd5 cxd5 Nc5 Nc4 Ne6 Qg8 Qg6 Ra1 Bf4 Rxf1+ Kxf1 Bf6 Nc7 Bd8 Qe6) 0.01/30 1} Bd8 {(Bd8 Ne3 Bc7 Qh4 Qe8 Bc2 Nd6 Nc5 Ra2 Bb1 Ra1 Bb2 Ra8 Bc1 Qg6 Qh3 Re8 Qh4 h6 Na6 Bd8 Qg3 Qxg3 hxg3 Nd5) 1.00/33 16} 25. Ne3 {(Ne3 Be7 Nf5 h6 Qxg7#) 0.00/36 56} Bc7 {(Bc7) 0.90/32 19} 26. Qh4 {(Qh4 Qe8 Nf5 Nd5 Bg5 Nd6 Ne7 Bf7 Nxd5 Bxd5 Nc5 Ra1 Bf4 Nf5 Qg4 Bxf4 Qxf4 Qe7 Qxf5 h6) -0.08/33 55} Qe8 {(Qe8) 0.97/35 28} 27. Nf5 {(Nf5 Nd5 Bg5 Nd6 Ne7 Nxe7 Bxe7 Bd8 Bxd8 Qxd8 Qxd8 Rxd8 Nc5 Ra8 Re1 Ra3 Nxe4 Nxe4 Rxe4 Rxc3 Bf3 Rc4 Re8 Rxb4 Bxc6) -0.09/31 22} Nd5 {(Nd5) 0.63/34 18} 28. Bg5 {(Bg5 Nd6 Ne7 Bf7 Na5 Bxa5 bxa5 Rxa5 Bb3 Nxe7 Bxf7 Nxf7 Bxe7 e3 Re1 Ra7 Bc5 Ra2) -0.10/32 17} Nd6 {(Nd6 Ne7 Bf7 Nc5 Ra1 Nxd5 Bxd5 Be2 Rxf1+ Bxf1 e3 Bd3 Bg8 Qe1 Nc4 Bxc4 Bxc4 Bxe3 Qh5 h3 Qg6 Nd7 Bd5 Qd2 Qb1+) 0.77/34 16} 29. Ne7 {(Ne7 Nxe7 Bxe7 Bd8 Bxd8 Qxd8 Qg3 Bc4 Re1 h6 Nc5 Ra1 Bg4 Rxe1+ Qxe1 Qg5 Bd7 e3 Be6) -0.24/33 24} Bf7 {(Bf7) 0.80/34 21} 30. Na5 {(Na5 Bxa5 bxa5 Rxa5 Bb3 Nxe7 Bxf7 Nxf7 Bxe7 e3 Re1 Ra2 Rxe3 Ra1+ Kf2 Nh6 Qe4 Ra2+ Kg1 Ra1+ Kf2) 0.00/31 6} Bxa5 {(Bxa5) 0.48/35 23} 31. bxa5 {(bxa5 Rxa5 Bb3 Nxe7 Bxf7 Nxf7 Bxe7 e3 Re1 Ra2 Rxe3 Nd6 Rf3 Ra1+ Kf2 Ra2+ Kg1) 0.00/37 22} Rxa5 {(Rxa5) 0.36/35 26} 32. Bb3 {(Bb3 Nxe7 Bxf7 Nxf7 Bxe7 e3 Re1 Ra2 Rxe3 Nd6 Rf3 Ra1+ Kf2 Ra2+ Kg1) 0.00/37 22} e3 {(e3) 1.41/33 15} 33. Bc2 {(Bc2 h5 Nxd5 e2 Re1 Bxd5 Be7 Ra2 Bb1 Ra1 Bxd6 Rxb1 Rxb1 Qg6 Kf2 Qxb1 Qxh5+ Kg8 Qe8+ Kh7 Qh5+ Kg8) 0.00/33 23} h5 {(h5) 1.33/31 10} 34. Nxd5 {(Nxd5 e2 Re1 Bxd5 Be7 Ra2 Bb1 Ra1 Bxd6 Rxb1 Rxb1 Qg6 Kf2 Qxb1 Qxh5+ Kg8 Qe8+ Kh7 Qh5+ Kg8) 0.00/32 18} cxd5 {(cxd5 Qf4 e2 Re1 Ra1 Bh4 Rxe1+ Bxe1 Bg6 Bxg6 Qxg6 Qe5 Qf5 Qxe2 Kg8 h3 Qe4 Kf2 Qxe2+ Kxe2 Kf7 Kd3 Kf6 Kc2 Nc4) 0.72/34 13} 35. Qf4 {(Qf4 e2 Re1 Qe6 Qe5 Ne4 Bxe4 dxe4 Rxe2 Qg4) -0.07/31 11} e2 {(e2) 0.73/38 23} 36. Re1 {(Re1 Qe6 Qe5 Ra2 Bb1 Rb2 Qxe6 Bxe6 Kf2 Rb3 Kxe2 Rxc3 Kd2 Rc6 Be7 Nc4+ Kc3 Na3+ Bc5 Nxb1+ Rxb1 Bf5 Rxb5 Kh7 g3) -0.20/34 32} Ra1 {(Ra1) 0.69/38 21} 37. Kf2 {(Kf2 Rxe1 Kxe1 Qc8 Qf3 Kg8 Be7 Ne4 Bb4 Bg6 Bd3 Qc7 Bxe4 dxe4 Qg3 Qf7 Qf2 Qd5 Kxe2 Bf7 Qf4 Qa2+ Qd2 Qd5 Kf2) -0.14/35 21} Rxe1 {(Rxe1) 0.73/29 10} 38. Kxe1 {(Kxe1 Qc8 Qf3 Kg8 Be7 Ne4 Bb4 Bg6 Bd3 Qc7 Bxe4 dxe4 Qg3 Qf7 Qf2 Qd5 Kxe2 Bf7 Qf4 Qa2+ Qd2 Qa1 Ke3 Bd5 Kf2) -0.14/35 18} Qc6 {(Qc6) 0.98/33 33} 39. Qe3 {(Qe3 b4 Be7 b3 Bxb3 Nf5 Qf3 Nxe7 Qxf7 Qxc3+ Kxe2 Qb2+ Ke1 Qxb3 Qxh5+ Kg8 Qe8+ Kh7 Qh5+ Kg8) 0.00/33 20} b4 {(b4 Bf4 Nb5 Be5 Kg8 Qd3 Qxc3+ Kxe2 Qxd3+ Bxd3 Be8 Kd2 Kf7 Kc2 Na7 Be2 Kg6 Bd3+ Kh6 Bf4+ g5 Bd6 Bg6 Bf8+ Kh7) 0.99/32 16} 40. Be7 {(Be7 b3 Bxb3 Nf5 Qf3 Nxe7 Qxf7 Qxc3+ Kxe2 Qb2+ Ke1 Qxb3 Qxh5+ Kg8 Qe8+ Kh7 Qh5+ Kg8) 0.00/40 22} b3 {(b3 Bxb3 Ne4 Bc2 Nxc3 Bc5 Ne4 Bxe4 dxe4 Qxe2 e3 Qf3 Bd5 Qxh5+ Kg8 Qg5 Qa8 Qxe3 Bxg2 Kf2 Be4 Qf4 Bh1 Qg5 Qf3+) 1.03/30 11} 41. Bxb3 {(Bxb3 Nf5 Qf3 Nxe7 Qxf7 Qxc3+ Kxe2 Qb2+ Ke1 Qxb3 Qxh5+ Kg8 Qe8+ Kh7 Qh5+ Kg8) 0.00/42 25} Ne4 {(Ne4 Bc2 Nxc3 Bc5 Qf6 Qf3 Qh4+ Qg3 Qxg3+ hxg3 Be6 Bd3 Bg4 Bb4 Nd1 Bxe2 Ne3 Bd3 Nf5 Kd2 Nxg3 Ke3 Nf5+ Bxf5 Bxf5) 0.28/34 12} 42. Bb4 {(Bb4 Qg6 Qxe2 Qg5 Bc2 Qf5) 0.00/35 14} Qf6 {(Qf6 Kxe2 Qa6+ Qd3 Qg6 Qf3 Qg5 c4 Be6 h3 dxc4 Bc2 Nf6 Bd2 Qb5 Bc1 Bd5 Qg3 Qb6 Kf1 Qxd4 Qe3 Qxe3 Bxe3 Be4) 1.56/35 18} 43. Qxe2 {(Qxe2 Qf4 Bc2 Qc1+ Qd1 Qe3+ Qe2 Qg1+ Qf1 Qe3+ Qe2) 0.00/38 20} Qh4+ {(Qh4+ g3 Qg5 Bc2 Bg6 Bxe4 Bxe4 Bd6 Kg8 Be5 Kh7 Kf2 Qf5+ Ke3 Kg8 h4 Qg6 Kd2 Qf5 Bf4 Qf7 Ke3 Qg6 Kd2 Kh7) 0.56/31 20} 44. g3 {(g3 Qg5 Kd1 Bg6 Bc2 Kh7 Bxe4 Bxe4 Bd6 Bg6 h4 Qf5 Ke1 Qb1+ Kf2 Qc1 Bb4 Qb1 Qf3 Qc2+ Kg1 Qb3 Qe2 Qb1+ Kf2) 0.00/40 20} Qg5 {(Qg5 Bc2 Bg6 Bxe4 Bxe4 Bd6 Kg8 Be5 Kh7 h4 Qf5 Qe3 Qc8 Qd2 Bg6 Kf2 Qf5+ Bf4 Qh3 Qe2 Qh2+ Kf1 Qh1+ Kf2 Qa1) 0.25/33 14} 45. Kd1 {(Kd1 Bg6 Bc2 Kh7 Bxe4 Bxe4 Bd6 Bg6 h4 Qf5 Ke1 Qb1+ Kf2 Qc1 Bb4 Qb1 Qf3 Qc2+ Kg1 Qb3 Qe2 Qb1+ Kf2 Qc1 Qf3) 0.00/42 34} Bg6 {(Bg6 Bc2 h4 Bxe4 dxe4 Ke1 hxg3 hxg3 Qxg3+ Kd2 Kg8 Qe3 Qh2+ Qe2 Qg1 Qe1 Qg4 Qe2 Qg5+ Qe3 Qg2+ Qe2 Qh1 Qf2 Qh3) 1.49/29 9} 46. Bc2 {(Bc2 Kh7 Bxe4 Bxe4 Bd6 Bg6 h4 Qf5 Ke1 Qb1+ Kf2 Qc1 Bb4 Qb1 Qf3 Qc2+ Kg1 Qb3 Qe2 Qb1+ Kf2 Qc1 Qf3 Qc2+) 0.00/45 41} h4 {(h4 Bxe4 dxe4 Ke1 hxg3 hxg3 Qxg3+ Kd2 Kg8 Qe3 Qh2+ Qe2 Qh1 Qg4 Bh5 Qe6+ Kh7 Qf5+ Bg6 Qf4 Qh3 Qe3 Qh2+ Qe2 Qh1) 0.55/32 22} 47. Bxe4 {(Bxe4 dxe4 Qf2 Bh5+ Kc2 e3 Qf4 Qg6+ Kb2 Bd1 Qxe3 Qc2+ Ka1 hxg3 Qe8+ Kh7 hxg3 Qc1+ Ka2 Qd2+ Ka1 Qc1+) 0.00/36 21} dxe4 {(dxe4) 0.19/30 10} 48. Qf2 {(Qf2 Bh5+ Kc2 e3 Qf4 Qg6+ Kb2 Bd1 Qxe3 Qc2+ Ka1 hxg3 Qe8+ Kh7 hxg3 Qc1+ Ka2 Qd2+ Ka1 Qc1+) 0.00/35 8} e3 {(e3) 0.00/28 33} 49. Qf4 {(Qf4 Bh5+ Kc2 Qg6+ Kb2 Bd1 Qxe3 Qc2+ Ka1 hxg3 Qe8+ Kh7 hxg3 Qc1+ Ka2 Qd2+ Ka1 Qc1+) 0.00/35 9} Bh5+ {(Bh5+ Kc2 Qd5 Qxe3 h3 Qe7 Qa2+ Kc1 Qxh2 Qh4 Qg1+ Kb2 Qf2+ Kb3 Qf7+ Kb2 Qf5 g4 Qxg4 Qxg4 Bxg4 Bd6 Be6 Kc2 Bc4) 0.00/29 8} 50. Kc2 {(Kc2 Qg6+ Kb2 Bd1 Qxe3 Qc2+ Ka1 hxg3 Qe8+ Kh7 hxg3 Qc1+ Ka2 Qd2+ Ka1 Qc1+) 0.00/36 18} Qd5 {(Qd5 Qxe3 h3 Qe7 Qa2+ Kc1 Qxh2 Qh4 Qg1+ Kb2 Qf2+ Kb3 Qf7+ Kb2 Qf5 g4 Qxg4 Qxg4 Bxg4 Bd6 Be6 Kc2 Bc4 Kd2 g5) 0.00/32 10} 51. Qxe3 {(Qxe3 Qa2+ Kc1 Qa1+ Kc2 Bg6+ Kd2 Qa2+ Ke1 hxg3 hxg3 Qb1+ Ke2 Qa2+ Ke1) 0.00/35 19} h3 {(h3 Qe7 Qa2+ Kc1 Qxh2 Qh4 Qg1+ Kb2 Qf2+ Kb3 Qf7+ Kb2 Qf5 g4 Qxg4 Qxg4 Bxg4 Bd6 Be6 Kc2 Bc4 Kd2 g5 Ke3 Kg7) 0.00/34 18} 52. Qd2 {(Qd2 Qa2+ Kd3 Bg6+ Ke3 Qe6+ Kf2 Qe4 Ba3 Qg2+ Ke3 Qh1 Bb4 Qb1 Kf3 Qd1+ Qxd1 Bh7) 0.00/37 23} Kg8 {(Kg8) 0.00/31 16} 53. Kc1 {(Kc1 Qh1+ Kb2 Qd5 Bc5 Qb7+ Ka3 Bf7 Qc2 Qa6+ Kb4 Qb7+ Ka5 Qa8+ Kb6 Qb8+ Kc6 Qc8+ Kb5 Be8+ Ka5 Qa8+ Kb4 Qb7+ Ka3) 0.00/36 24} Bf7 {(Bf7 Kb2 Qa2+ Kc1 Qa1+ Kc2 Qa4+ Kb2 Bb3 Kb1 Qa8 Bd6 Bd5 Kb2 Qa2+ Kc1 Qa5 Kb2 Be6 Be5 Qb6+ Kc1 Qc6 g4 Qf3) 1.33/25 9} 54. Qe2 {(Qe2 Qg5+ Kc2 Qf5+ Kb2 Qd5 Kc1) 0.00/38 15} Bh5 {(Bh5 Qd2 Bf7 Qe2 Bh5) 0.00/35 13} 55. Qc2 {(Qc2 Qg2 Bd6 Bf7 Be5 Qh1+ Kb2 Qg2 d5 Qxd5 Bd4 Qa2+ Kc1 Qe6 Kd2 Qh6+ Ke1 Qc6 Qe2 Bc4 Qf2 Qh1+ Kd2 Qe4 Qe1) 0.00/35 10} Bg4 {(Bg4) 0.00/35 16} 56. Bc5 {(Bc5 Qf3 Qa2+ Kh7 Qd2 Bf5 Kb2 Bd3 Ka3 Qa8+ Kb2 Qb7+ Ka3 Qa6+ Kb3 Qb5+ Bb4 Qd5+ Ka3 Qa8+ Kb3 Qd5+) 0.00/33 15} Qf3 {(Qf3 Bd6 Be6 Be5 Bc4 Qg6 Qxc3+ Qc2 Qe1+ Kb2 Qb4+ Kc1 Kh8 Qf5 Qc3+ Qc2 Qe1+ Kb2 Bg8 Qc7 Qd2+ Ka3 Qa2+ Kb4 Qb3+) 0.00/32 11} 57. Qa2+ {(Qa2+ Kh7 Qd2 Bf5 Kb2 Bd3 Ka3 Qa8+ Kb2 Qb7+ Ka3 Qa6+ Kb3 Qb5+ Bb4 Qd5+ Ka3 Qa8+ Kb3 Qd5+) 0.00/35 21} Kh8 {(Kh8 Kb2 Qe2+ Ka3 Qe3 Kb4 Qe4 Qf7 Be6 Qe8+ Kh7 Qh5+ Kg8 Qe8+ Kh7) 0.00/33 14} 58. Qd2 {(Qd2 Bf5 Qa2 Qxc3+) 0.00/33 9} Bf5 {(Bf5) 0.00/34 12} 59. Kb2 {(Kb2 Qf1 Ka3 Qa6+ Kb2 Qb5+ Bb4 Qd5 Qf4 Qg2+ Ka3 Be6 Qh4+ Kg8 Qd8+ Kh7 d5 Bxd5 Qh4+ Kg8 Qd8+ Kh7) 0.00/34 6} Qb7+ {(Qb7+ Bb4 Be6 Kc1 Qe4 d5 Bxd5 c4 Qxc4+ Bc3 Kg8 Qd4 Qf1+ Kb2 Qb5+ Ka1 Qf1+ Kb2) 0.00/37 14} 60. Bb4 {(Bb4 Qd5 Qf4 Qg2+ Ka3 Be6 Qh4+ Kg8 Qd8+ Kh7 d5 Bxd5 Qh4+ Kg8 Qd8+ Kh7) 0.00/35 11} Be6 {(Be6 Kc1 Qe4 d5 Bxd5 c4 Qxc4+ Bc3 Kg8 Qd4 Qf1+ Kb2 Qb5+ Ka1 Qf1+ Kb2) 0.00/38 14} 61. d5 {(d5 Bxd5 Qg5 Kg8 Qd8+ Kf7 Qf8+ Kg6 Qd6+ Kh7 Qc5 Qa8 c4 Bf7 Qf5+ Kg8 Kb3 Qg2 Qg4 Kh7 Qh4+ Kg8) 0.00/35 16} Bxd5 {(Bxd5 c4 Bg8 Kc1 Qa8 Bc3 Qb7 Qg5 Qh1+ Kb2 Qb7+ Ka3 Qa6+ Kb2 Qb7+) 0.00/35 5} 62. Qg5 {(Qg5 Kg8 Qd8+ Kf7 Qf8+ Kg6 Qd6+ Kh7 Qc5 Qa8 c4 Bf7 Qf5+ Kg8 Kb3 Qg2 Qc8+ Kh7 Bc3 Qxh2 Qf5+ Bg6 Qe5 Qc2+ Kb4) 0.00/35 6} Kg8 {(Kg8 Qd8+ Kf7 Qf8+ Kg6 Qd6+ Kh7 Qe7 Qc8 c4 Bxc4 Bc3 Qg4 Qh4+ Qxh4 gxh4 Kg6 Kc1 Kh5 Bxg7 Kxh4) 0.00/37 13} 63. Qd8+ {(Qd8+ Kf7 Qf8+ Kg6 Qd6+ Kh7 Qc5 Bf7 Qf5+ Kg8 Qxh3 Qd5 Qc8+ Kh7 c4 Qh1 Qg4 Qxh2+ Kb3 Qf2 Qh3+ Kg8 Qg4 Bg6 Qxg6) 0.00/35 14} Kf7 {(Kf7) 0.00/37 9} 64. Qf8+ {(Qf8+ Kg6 Qd6+ Kh7 Qc5 Bf7 Qf5+ Kg8 Qxh3 Qd5 Qc8+ Kh7 c4 Qe4 Kb3 Qd3+) 0.00/35 6} Kg6 {(Kg6 Qd6+ Kh7 Qe7 Qc8 c4 Bxc4 Bc3 Qg4 Qh4+ Qxh4 gxh4 Kg6 Kc1 Kh5 Bxg7 Kxh4) 0.00/38 14} 65. Qd6+ {(Qd6+ Kh7 Qc5 Bf7 Qf5+ Kg8 Qxh3 Qd5 Qc8+ Kh7 c4 Qe4 Kb3 Qd3+ Bc3 Qb1+ Bb2 Qd1+ Kb4 Qe1+ Bc3 Qb1+) 0.00/36 18} Kh7 {(Kh7) 0.00/39 12} 66. Qc5 {(Qc5 Bf7 Qf5+ Kg8 Qxh3 Qd5 Qc8+ Kh7 c4 Qe4 Kb3 Qd3+ Bc3 Qb1+ Bb2 Qd1+ Kb4 Qe1+ Bc3 Qb1+ Ka4 Qc2+ Kb5 Qxc3 Qf5+) 0.00/35 22} Bf7 {(Bf7 Qf5+ Kg8 Qxh3 Bc4 Qg4 Qg2+ Kc1 Bd3 Qd1 Qe4 Kb2 Kh7 Qh5+ Kg8 Qc5 Qe2+ Kb3 Kh7 Qd4 Qc2+ Ka3 Qc1+ Ka4 Qf1) 0.00/39 11} 67. Qf5+ {(Qf5+ Kg8 Qxh3 Qd5 Qc8+ Kh7 c4 Qe4 Kb3 Qd3+ Bc3 Qb1+ Bb2 Qd1+ Kb4 Qe1+ Bc3 Qb1+ Ka4 Qc2+ Kb5 Qxc3 Qf5+ Kg8 Qc8+) 0.00/38 12} Kg8 {(Kg8) 0.00/40 8} 68. Qxh3 {(Qxh3 Qd5 Qc8+ Kh7 c4 Qe4 Kb3 Qd3+ Bc3 Qb1+ Bb2 Qd1+ Kb4 Qe1+ Bc3 Qb1+ Ka4 Qc2+ Kb5 Qxc3 Qf5+ Kg8 Qc8+ Kh7) 0.00/39 12} Bc4 {(Bc4 Qg4 Qg2+ Kc1 Bd3 Qd1 Qe4 Kb2 Kh7 Qh5+ Kg8 Qc5 Qe2+ Kb3 Bc2+ Ka3 Bd3 Kb3) 0.00/41 12} 69. Qf5 {(Qf5 Qa8 Qc2 Qa2+ Kc1 Qa1+ Qb1 Qa8 Kb2 Bf7 Qc2 Qa2+ Kc1 Qa6 Qd1 Qa2 Qd2 Qa1+ Kc2 Qa4+ Kb1 Qa6 Qg2 Bg6+ Kb2) 0.46/33 8} Qg2+ {(Qg2+ Qc2 Qd5 Qf2 Bd3 Qd4 Qg2+ Ka1 Bc2 Qd8+ Kh7 Qh4+ Kg8 Qd8+) 0.00/35 6} 70. Qc2 {(Qc2 Qa8 Bc5 Bf7 Ba3 Qa6 Bb4 Qa2+ Kc1 Qa6 Qd1 Qa2 Qd2 Qa1+ Kc2 Qa4+ Kb1 Qa6 Bd6 Qb5+ Kc1 Bg6 Bb4 Kh7 Kb2) 0.46/32 7} Qd5 {(Qd5) 0.00/38 11} 71. h4 {(Ka3 Qb7 Qf5 Bf7 Kb2 Qa8 Qc2 Qa2+ Kc1 Qa6 Qd1 Qa2 Qd2 Qa1+ Kc2 Qa4+ Kb1 Qa6 Bd6 Qb5+ Kc1 Bg6 Bb4 Kh7 Kb2) 0.46/31 12} Qf3 {(Qf3 h5 Bf7 Qd2 Qxg3 h6 gxh6 Qxh6 Qf2+ Kc1 Qf1+ Kb2 Qe2+ Kc1 Qe1+ Kb2 Qe2+) 0.00/37 9} 72. Bd6 {(Bd6 Qc6 Bf4 Qb6+ Kc1 Qg1+ Qd1 Qa7 Bd6 Qa1+ Kd2 Qb2+ Qc2 Qb5 Bf4 Qb6 Qe4 Qb2+ Qc2 Qb6) 0.60/27 5} Be6 {(Be6 Be5 Qb7+ Kc1 Qh1+ Qd1 Qe4 Qd8+ Kh7 Qg5 Qe1+ Kc2 Qe2+ Kb1 Qf1+ Kb2 Qf2+ Ka3 Qa2+ Kb4 Qc4+ Ka5 Qc5+ Ka4 Qc6+) 0.00/31 9} 73. Be5 {(c4 Qf6+ Kb3 Qd4 Bb4 Qe3+ Qc3 Qe2 Bc5 Qd1+ Kb4 Qb1+ Qb3 Qe4 Bb6 Qb7 Qe3 Qh1) 0.71/26 8} Bf7 {(Bf7 Bd4 Qxg3 Qe4 Qh2+ Kc1 Qh3 Qf4 Qh1+ Kd2 Qg2+ Kd3 Qh3+ Ke2 Qg2+ Ke3 Qg1+ Qf2 Qc1+ Qd2 Qg1+ Kf4 Qh1 Kg3 Bd5) 0.00/35 18} 74. Bf4 {(Bf4 Qb7+ Kc1 Qf3 Bc7 Qd5 Qd2 Qe4 Bf4 Bg6 Qa2+ Kh7 Kb2 Qe2+ Kc1 Qxa2 c4) 0.52/27 3} Qb7+ {(Qb7+ Kc1 Qh1+ Kb2 Qe1 Qf5 Qe2+ Kc1 Qf1+ Kd2 Qg2+ Kc1 Qg1+ Kb2 Qb6+ Kc1 Qg1+) 0.00/33 6} 75. Kc1 {(Kc1 Qf3 Bd6 Qe3+ Qd2 Qe4 Qf2 Bg6 Kb2 Qb7+ Bb4 Bf7 Qe2 Qd5 Qc2 Qa2+ Kc1 Qa1+ Qb1 Qa8 Qd3 Qa1+ Kc2 Bg6 Qxg6) 0.46/33 8} Qf3 {(Qf3 Kd2 Bc4 Kc1 Bf7) 0.00/36 28} 76. Bc7 {(Bd6 Qe3+ Kb2 Qb6+ Bb4 Qa7 Qd3 Qf2+ Kc1 Qe1+ Kc2 Qf2+ Kd1 Qg1+ Kd2 Qg2+ Kc1 Qg1+ Kd2) 0.46/32 9} Bd5 {(Bd5) 0.00/35 7} 77. Qd2 {(Qd2 Bf7 Qd4 Qe2 Qe5 Qa2 Kd1 Qb1+ Kd2 Qb7 Ke3 Qa7+ Kf3 Qb7+ Kf2 Qa7+ Ke1 Qa1+ Ke2 Qg1 Kd2 Qf1 Qe4 Qf2+ Qe2) 0.53/28 18} Be4 {(Be4 Be5 Qf1+ Qd1 Qb5 Qd4 Qe2 Qd2 Qf1+) 0.00/35 8} 78. Kb2 {(Kb2 Bg6 Qd4 Bf7 Kc1 Qe2 Qd8+ Kh7 Qd1 Qe8 Bf4 Bg6 Kb2 Qb5+ Qb3 Qe2+ Ka3 Qe4 Qb4 Qxb4+ cxb4 Be4) 0.60/31 15} Bd3 {(Bd3 Qf4 Qg2+ Ka3 Kh7 Be5 Qb7 g4 Qe7+ Bd6 Qa7+ Kb2 Qb7+ Ka3 Qa6+ Kb2 Qb7+) 0.00/32 8} 79. Qf4 {(Qf4 Qb7+ Ka3 Bg6 Bd6 Qa6+ Kb4 Qb6+ Kc4 Qa6+ Kc5 Qa7+ Kd5 Qb7+ Kd4 Qa7+ Bc5 Qe7) 0.64/28 11} Qg2+ {(Qg2+) 0.00/34 10} 80. Ka3 {(Ka3 Qa8+ Qa4 Qf8+ Kb3 Qc5 Bf4 Kh7 c4 Be2 Kc3 Qf5 Qb3 Qd3+ Kb4 Qe4 Kc5 Kg8 Bd6 Qf5+ Kd4 Qf1 Qc3) 0.82/25 11} Kh7 {(Kh7 Be5 Qb7 g4 Qe7+ Bd6 Qa7+ Kb2 Qb7+ Ka3 Qa6+ Kb2 Qb7+) 0.00/34 42} 81. Qd4 {(c4 Qb7 Ba5 Bc2 Qe3 Qc6 c5 Bg6 Bc3 Qa6+ Kb4 Qb7+ Kc4 Qf7+ Kb5 Qb7+ Ka4 Qa6+ Kb3 Qb5+ Ka3 Bf7 Bd4 Kg8 Qc3) 0.90/26 11} Qa8+ {(Qa8+ Kb4 Qb7+ Bb6 Qe7+ Bc5 Qb7+ Bb6) 0.00/32 5} 82. Kb4 {(Kb4 Qb7+ Bb6 Qe7+ Kb3 Qe6+ Ka3 Bg6 Bc5 Qa6+ Kb4 Qb7+ Bb6 Qe7+ Kb3 Qe2 c4 Qc2+ Kb4 Qb1+ Kc5 Qf5+ Qd5 Qf2+ Kc6) 0.80/31 13} Qb7+ {(Qb7+ Bb6 Qe7+ Bc5 Qb7+ Bb6) 0.00/32 9} 83. Bb6 {(Bb6 Qe7+ Kb3 Qe6+ Ka3 Bg6 Bc5 Qa6+ Kb4 Qb7+ Bb6 Qe7+ Kb3 Qe2 c4 Bf7 Bc7 Qf3+ Kb4 Qb7+ Kc3 Qxc7 c5) 0.80/31 15} Qe7+ {(Qe7+) 0.00/34 6} 84. Kb3 {(Kb3 Qe6+ Ka3 Bg6 Bc5 Qa6+ Kb4 Qb7+ Bb6 Qe7+ Kb3 Qe2 c4 Qc2+ Kb4 Qb1+ Kc5 Qf5+ Kd6 Qf8+ Kc7 Qf7+ Kb8 Qe8+ Qd8) 0.78/30 4} Qe6+ {(Qe6+ Kb4 Qe7+ Bc5 Qb7+ Bb6 Qe7+) 0.00/32 5} 85. Ka3 {(Ka3 Bg6 Bc5 Qa6+ Kb4 Qb7+ Bb6 Qe7+ Kb3 Qe2 c4 Qc2+ Kb4 Qb1+ Kc5 Qf5+ Kd6 Qf8+ Kc7 Qf7+ Kb8 Qe8+ Qd8 Qa4 c5) 0.78/29 5} Bg6 {(Bg6) 0.00/33 5} 86. Bc5 {(Bc5 Qa6+ Kb4 Qb7+ Bb6 Qe7+ Kb3 Qe2 c4 Qc2+ Kb4 Qb1+ Kc5 Qf5+ Kd6 Qf8+ Kc7 Qf7+ Kb8 Qf8+ Bd8 Qa3 g4 Qb4+ Kc7) 0.74/29 4} Qa6+ {(Qa6+) 0.00/33 5} 87. Kb4 {(Kb4 Qb7+ Bb6 Qe7+ Kb3 Qe2 c4 Qc2+ Kb4 Qb1+ Kc5 Qf5+ Kd6 Qf8+ Kc7 Qf7+ Kb8 Qf8+ Qd8 Qa3 Qc7 Be4 Ba5 Qa4 Ka7) 0.61/32 16} Qb7+ {(Qb7+) 0.00/34 5} 88. Bb6 {(Bb6 Qe7+ Kb3 Qe2 c4 Qc2+ Kb4 Qb1+ Kc5 Qf5+ Kd6 Qf8+ Kc7 Qf7+ Kb8 Qf8+ Qd8 Qa3 Qc7 Be4 Ba5 Qa4 Ka7 Bd3 c5) 0.61/30 10} Qe7+ {(Qe7+ Bc5 Qb7+ Ka5 Qc7+ Kb5 Qxg3 Kb4 Qb8+ Ka5 Qc7+ Bb6 Qc6 Qe5 Qa8+ Kb4 Be8 Kb3 Qb7 Qxe8 Qxb6+ Kc4 Qc7+ Kd5 Qxc3) 0.00/34 5} 89. Qc5 {(Qc5 Qe4+ Ka3 Qa8+ Kb3 Bf7+ Kb4 Qe4+ Ka5 Qa8+ Ba7 Qd8+ Kb4 Qd7 Qd4 Qb7+ Ka5 Qc7+ Kb4 Qxg3 Kc5) 0.60/31 9} Qe4+ {(Qe4+ Ka5 Qa8+ Kb4 Qe4+) 0.00/32 6} 90. Ka3 {(Ka3 Qa8+ Kb3 Bf7+ Kb4 Qe4+ Ka5 Qa8+ Ba7 Qd8+ Kb4 Qd7 Qd4 Qb7+ Ka5 Qc7+ Kb4 Qxg3 Kc5) 0.60/31 11} Qb1 {(Qb1) 0.00/32 6} 91. Bc7 {(Bc7 Be8 Qe5 Qa1+ Kb4 Qa4+ Kc5 Qa7+ Kd6 Qa6+ Ke7 Qc8 Qe4+ Bg6 Qf4 Bf5 Kd6 Qa6+ Kc5 Qa3+ Kb6 Qb3+ Qb4 Qg8 Qd4) 0.76/28 9} Be8 {(Be8) 0.00/33 8} 92. Qe5 {(Qe5 Qa1+ Kb4 Qa4+ Kc5 Qa7+ Kd5 Bf7+ Kc6 Qa6+ Bb6 Qc8+ Kd6 Qb8+ Bc7 Qa7 Qd4 Qb7 g4 Bg8 g5 Qc8 Kc6 Qa6+ Bb6) 0.76/30 8} Bg6 {(Bg6 Qc5 Be8 Be5 Qa1+ Kb3 Qb1+ Ka3) 0.00/32 11} 93. Ka4 {(Ka4 Qc2+ Kb4 Qb2+ Kc5 Qa3+ Kc6 Qa4+ Kb6 Qb3+ Ka5 Qa3+ Kb5 Qb3+ Kc6 Qc4+ Kd6 Qa6+ Kc5 Qa3+) 0.75/27 10} Qb7 {(Qb7 Ka5 Bd3 Qh5+ Kg8 Qc5 Kh7 Be5 Qa6+ Kb4 Qb7+ Ka3 Qa8+ Kb2 Qg2+ Kb3 Qb7+ Ka3) 0.00/29 35} 94. Ka5 {(Ka5 Qa7+ Kb5 Bd3+ c4 Qb7+ Kc5 Kg8 Kd4 Kh7 Kxd3 Qb1+ Ke3 Qb3+ Kf4 Qxc4+ Ke3 Qd3+ Kxd3 Kg8) 0.79/27 5} Bd3 {(Bd3) 0.00/31 7} 95. Qh5+ {(Qh5+ Kg8 Qc5 Kh7 g4 Qa8+ Kb4 Qg2 Qd4 Qb7+ Bb6 Qe7+ Kb3 Qe6+ Kb2 Bg6 g5 Qe1 Kb3 Be8 Kb4 Qb1+ Kc5 Qb5+ Kd6) 0.78/32 9} Kg8 {(Kg8) 0.00/30 4} 96. Qc5 {(Qc5 Kh7 g4 Qa8+ Kb4 Qg2 Qd4 Qb7+ Bb6 Qe7+ Kb3 Qe6+ Kb2 Qe2+ Ka3 Bc2 Qf2 Qa6+ Kb2 Bg6 h5 Qb5+ Ka3 Be4 Bd4) 0.80/32 12} Kh7 {(Kh7) 0.00/32 11} 97. g4 {(g4 Qg2 Qd4 Be2 g5 Qc6 Kb4 Qb5+ Ka3 Bc4 Qb6 Qf5 Bd6 Qc2 Be5 Bf7 Qb5 Qa2+ Kb4 Qb1+ Ka5 Qa2+ Kb6 Bc4 Qc5) 0.72/31 10} Qa6+ {(Qa6+) 0.00/31 7} 98. Kb4 {(g4 Qg2 Qd4 Qa8+ Kb6 Be4 Qc5 Qb7+ Ka5 Qa8+ Kb4 Qc8 Qh5+ Kg8 c4 Qxc7 Qe8+ Kh7 Qxe4+ Kh8) 0.72/32 1} Qb7+ {(Qb7+) 0.00/32 4} 99. Bb6 {(Bb6 Qe4+ Qd4 Qe7+ Kb3 Qe6+ Ka4 Qa2+ Kb4 Qb2+ Kc5 Bg6 h5 Qb1) 0.78/33 13} Qe4+ {(Qe4+ Qd4 Qe7+ Kb3 Qe6+ Kb4 Be2 Bc7 Bxg4 Be5 Qe7+ Bd6 Qe6 Be5) 0.00/31 4} 100. Qd4 {(Qd4 Qe7+ Kb3 Qe6+ Ka4 Qe8+ Ka3 Bc2 Qc4 Qa8+ Kb4 Qf8+ Qc5 Qf4+ Qd4 Be4 Bc5 Qxg4 Bf8 Qg2 Bxg7 Qb2+ Ka5 Qa3+ Kb6) 0.72/34 11} Qe7+ {(Qe7+) 0.00/33 4} 101. Kb3 {(Kb3 Qe6+ Ka4 Qe8+ Ka3 Bc2 Qc4 Qa8+ Kb4 Qf8+ Qc5 Qf4+ Qd4 Be4 Bc5 Qxg4 Bf8 Qg2 Bxg7 Qb2+ Ka5 Qa3+ Kb6 Qb3+ Kc7) 0.72/33 5} Qe6+ {(Qe6+) 0.00/34 6} 102. Ka4 {(Ka4 Qe8+ Ka3 Bc2 Qc4 Qa8+ Kb4 Qf8+ Qc5 Qf4+ Qd4 Be4 Bc5 Qxg4 Bf8 Qg2 Bxg7 Qb2+ Ka5 Qa3+ Kb6 Qb3+ Kc7 Qb7+ Kd8) 0.72/33 9} Be4 {(Be4) 0.00/33 7} 103. g5 {(g5 Qa2+ Kb5 Qb3+ Ka6 Qa2+ Ba5 Qe6+ Kb5 Qf5+ Kb6 Qe6+ Kc5 Qf5+ Kb4 Qf4 h5 Qf1 Qxe4+ Kh8) 0.80/26 8} Qa2+ {(Qa2+) 0.00/35 6} 104. Kb4 {(Kb4 Qb2+ Kc5 Qa3+ Qb4 Qa8 Qc4 Qc6+ Kd4 Qb7 Ke5 Bg6 Bc7 Kh8 Kd6 Be4 Qc5 Kh7 Qd4 Qc6+ Ke5 Bg6 Bb6 Qe8+ Kd5) 0.80/32 8} Qb2+ {(Qb2+ Kc4 Qa2+ Kb4 Qb2+) 0.00/36 8} 105. Kc5 {(Kc5 Qa3+ Qb4 Qa8 Qc4 Qc6+ Kd4 Qb7 Ke5 Bg6 Bc7 Bc2 Kd6 Be4 Qd4 Bf3 Bb6 Kg6 Kc5 Kh5 c4 Bg4 Kd6 Kxh4 Bd8) 0.79/33 10} Qa3+ {(Qa3+ Kb5 Qb3+ Kc5 Qa3+) 0.00/34 6} 106. Qb4 {(Qb4 Qa8 Qc4 Bg6 Qf4 Qa3+ Qb4 Qa8 Bc7 Qa7+ Kd6 Qa6+ Qb6 Qa3+ Qc5 Qa6+ Ke7 Qb7 Kd7 Qe4 Qd4 Qf5+ Kc6 Qf8 Kb6) 0.79/32 10} Qa8 {(Qa8 Kd6 Qc6+ Ke7 Qb7+ Kd6 Qc6+) 0.00/33 5} 107. Qc4 {(Qc4 Qa3+ Kb5 Qb2+ Qb4 Qe2+ Ka5 Qa2+ Qa4 Qd5+ Kb4 Qd6+ Bc5 Qh2 Bd4 Qxh4 Qe8 Qf4 Qe7 Qb8+ Ka4 Qb7 Qxb7 Bxb7 c4) 0.70/31 9} Bg6 {(Bg6 Kb4 Be8 Qb3 Kh8 Bc5 Qc6 Bd4 Qb7+ Ka3 Qa8+ Kb2 Qg2+ Qc2 Qb7+ Ka3 Qa8+ Kb4 Qb7+ Kc5 Qc7+ Kb4 Qd6+ Bc5 Qb8+) 0.00/32 18} 108. Qf4 {(Qf4 Qa3+ Qb4 Qa8 Bc7 Qa7+ Kd6 Qa6+ Qb6 Qa3+ Qc5 Qa6+ Ke7 Qb7 Kd7 Qe4 Qd4 Qe8+ Kd6 Qe3) 0.79/29 4} Qa3+ {(Qa3+) 0.00/33 7} 109. Qb4 {(Qb4 Qa8 Bc7 Qa7+ Kd6 Qa6+ Qb6 Qa3+ Qc5 Qa6+ Ke7 Qb7 Kd7 Qe4 Qd4 Qe8+ Kd6 Qc8 Qe3 Qg4 Qd4 Qc8) 0.79/35 11} Qa8 {(Qa8) 0.00/34 5} 110. Bc7 {(Bc7 Qa7+ Kd6 Qa6+ Qb6 Qa3+ Qc5 Qa6+ Ke7 Qb7 Kd7 Qe4 Qd4 Qe8+ Kd6 Qc8 Qe3 Qg4 Qd4 Qc8) 0.79/34 10} Qa7+ {(Qa7+ Kd6 Qa8 Qd4 Qc8 Qe5 Qa6+ Ke7 Qa3+ Kd8 Qa8+ Kd7 Qa4+ Kd8 Qa8+) 0.00/34 7} 111. Kd6 {(Kd6 Qa6+ Qb6 Qa3+ Qc5 Qa6+ Ke7 Qb7 Kd7 Qe4 Qd4 Qe8+ Kd6 Qc8 Qe3 Qg4 Qd4 Qc8) 0.79/32 9} Qa8 {(Qa8) 0.00/36 8} 112. Qd4 {(Qd4 Qb7 Qc4 Be4 Ke5 Bg6 Ke6 Bc2 Kd6 Be4) 0.73/30 7} Qc8 {(Qc8 Qe5 Qa6+ Ke7 Qa3+ Kd8 Qa8+ Ke7 Qa3+) 0.00/35 6} 113. Qc4 {(Qc4 Qb7 Kd7 Be4 Ke7 Bg6 Kd6 Be4 Ke5 Bg6 Ke6 Bc2 Ke7 Bg6) 0.73/34 9} Qa8 {(Qa8) 0.00/38 7} 114. Kc5 {(Kc5 Qa7+ Kc6 Be8+ Kd6 Bg6 Ke6 Qb7 Be5 Bf7+ Kf5 Bxc4 Kg4) 0.73/31 8} Qa7+ {(Qa7+ Kc6 Be8+ Kd6 Bg6 Ke7 Qe3+ Kd6 Qa7) 0.00/36 6} 115. Kc6 {(Kc6 Be8+ Kd6 Bg6 Qd4 Qa8 Bb6 Qf8+ Kd7 Qf7+ Kc6 Qe6+ Kb7 Be8 Bc5 Qc6+ Kb8 Bg6 Qd6 Qb5+ Bb6 Qe8+ Qd8 Qf7 Bd4) 0.72/32 5} Be8+ {(Be8+) 0.00/38 6} 116. Kd6 {(Kd6 Bg6 Qd4 Qa8 Qe3 Qc8 Qf2 Qh3 Qe1 Qh2+ Kc6 Qg2+ Kc5 Qa8 Bg3) 0.67/32 10} Bg6 {(Bg6 Ke7 Qe3+ Kd6 Qa7) 0.00/38 11} 117. Qd4 {(Qd4 Qa8 Qe3 Qc8 Qf2 Qh3 Qe1 Qh2+ Kc6 Qg2+ Kc5 Qa8 Bg3 Qa7+ Kc6 Qa4+ Kb6 Qb3+ Kc5 Qa3+ Kc6 Qa6+ Kc7 Qa7+ Kc6) 0.67/29 5} Qa6+ {(Qa6+ Kc5 Qa3+ Kc6 Qa6+ Kd5 Qb7+ Kd6 Qa6+) 0.00/23 5} 118. Bb6 {(Bb6 Qa8 Qf2 Qa3+ Qc5 Qa8 Qe5 Qb8+ Bc7 Qa8 Kc5 Qa3+ Kb6 Qb3+) 0.72/32 11} Qa8 {(Qa8 Ke5 Qb8+ Kd5 Qb7+ Kc5 Qe7+ Kd5 Qb7+) 0.00/34 8} 119. Qe5 {(Qf2 Be4 Ke5 Qd5+ Kf4) 0.72/29 8} Qb8+ {(Qb8+) 0.00/37 7} 120. Bc7 {(Bc7 Qa8 Qc5 Qa2 Bb6 Qg8 Qe3 Qf8+ Kd5 Qf7+ Kc5 Qf5+ Kb4 Qb1+ Ka4 Bd3 Qe5 Qxb6 Qf5+ Bxf5 g6+ Bxg6 Ka3) 0.65/32 8} Qa8 {(Qa8) 0.00/38 11} 121. Qc5 {(Qc5 Qa2 Bb6 Qg8 Qe3 Qf8+ Kd5 Qf7+ Kc5 Qf5+ Kb4 Qb1+ Kc4 Bf7+ Kc5 Qf5+ Kd6 Qd5+ Kc7 Qc4+ Kb8 Qxh4 Qe5 Qh5 Bd4) 0.59/31 9} Qb7 {(Qb7) 0.00/30 6} 122. Qc6 {(Qc4 Be4 Ke5 Bg6 Ke6 Bc2 Ke7 Bg6 Kd6) 0.73/29 9} Qc8 {(Qc8) 0.00/35 6} 123. Ke7 {(Ke7 Qg4 Be5 Qxh4 Bxg7 Qxg5+ Bf6 Qe3+ Kd8 Bf7 Bd4 Qg5+ Kd7 Qd5+ Qxd5 Bxd5 Kd6 Bc4 Kc5 Bd3 Kb4 Kg6 Ka5) 0.51/27 4} Qf5 {(Qf5 Bd6 Qf7+ Kd8 Qg8+ Kc7 Qf7+ Kd8) 0.00/35 5} 124. Qc4 {(Qc4 Qc8 Qc5 Qe8+ Kd6 Qg8 Qf2 Qc8 Qe3 Qg4 Qf2 Qd1+ Kc5 Qa4 Qd4 Qxd4+ cxd4 Bc2) 0.65/31 11} Qc8 {(Qc8 Kd6 Qa8 Kc5 Qa7+ Bb6 Qb7 Qd4 Qe7+ Kd5 Qd7+ Ke5 Qe7+ Kf4 Qe2 Kg3 Qe1+ Kh2 Qe6 Bc5 Qe2+ Kg3 Qe1+ Qf2 Qxc3+) 0.00/31 5} 125. Qc5 {(Qc5 Bh5 Qe5 Bg6 c4 Bf5 Qd6 Bg6 Qd7 Qg8 Qe6 Qe8+ Kd6 Qf8+ Qe7 Qf3 Qe5 Qd3+ Qd5 Qg3+ Kd7 Qg4+ Kd8 Qxh4 Bd6) 0.56/31 9} Qe8+ {(Qe8+ Kd6 Qf7 Qd4 Qf3 Ke6 Qf7+ Kd6) 0.00/35 7} 126. Kd6 {(Qc5 Bh5 Qe5 Bg6 c4 Bf5 Qd6 Bg6 Qd7 Qg8 Qe6 Qe8+ Kd6 Qf8+ Qe7 Qf3 Qe5 Qd3+ Qd5 Qg3+ Kd7 Qg4+ Kd8 Qxh4 Bd6) 0.56/32 1} Qf7 {(Qf7 Qd4 Qf3 Ke6 Qf7+ Kd6) 0.00/37 10} 127. Qb4 {(Qb4 Qf2 Kd5 Be8 Qf4 Qa2+ Kc5 Qa3+ Qb4 Qa8 Be5 Qa7+ Qb6 Kg8) 0.71/29 6} Qf8+ {(Qf8+) 0.00/34 7} 128. Kc6 {(Kc6 Qf3+ Kb6 Qf2+ Qd4 Qb2+ Ka7 Qa3+ Kb7 Qb2+ Ka6 Qa2+ Kb7 Qg2+ Kc8 Qc6 Kb8 Be4 Bf4) 0.78/32 11} Qa8+ {(Qa8+) 0.00/34 8} 129. Kb6 {(Kb6 Qd5 Bd6 Bd3 Qc5 Qb3+ Kc7 Qf7+ Kc6 Be4+ Kb6 Qb7+ Ka5 Bd3 Bf4 Qa6+ Kb4 Qb7+ Ka3 Qa8+ Kb2 Qg2+ Kb3 Qh1 c4) 0.79/31 10} Be4 {(Be4 Be5 Qb7+ Ka5 Qa8+ Kb6) 0.00/35 7} 130. Qc5 {(Qc5 Qb7+ Ka5 Qb3 Be5 Qa2+ Kb4 Qb1+ Ka4) 0.79/30 8} Qb7+ {(Qb7+ Ka5 Qa8+ Kb6 Qb7+) 0.00/35 8} 131. Ka5 {(Qc5 Qb7+ Ka5 Qb3 Be5 Qa2+ Kb4 Qb1+ Ka4 Qa2+ Kb5 Qb3+ Qb4 Qd5+ Ka6 Qxe5 Qxe4+ Qxe4 g6+ Qxg6+ Ka7) 0.79/31 1} Qa8+ {(Qa8+ Kb6 Qb7+ Ka5 Qa8+) 0.00/35 6} 132. Kb4 {(Kb4 Qa2 Qc4 Qb2+ Ka5 Qa1+ Kb5 Qb2+ Qb4 Bd3+ Kb6 Qe2 Qd4 Qe6+ Ka7 Qa6+ Kb8 Qb5+ Bb6 Qe8+ Kb7 Be4+ Ka6 Bg6 Ka5) 0.79/32 16} Bc2 {(Bc2) 0.00/36 16} 133. Qd4 {(Qd4 Qa4+ Kc5 Qa7+ Bb6 Qe7+ Kb5 Bg6 Qd5 Bf7 Qd3+ Bg6 Qe3 Qd7+ Ka5 Qd5+ Bc5 Qa2+ Kb6 Qb2+ Kc6 Qb8) 0.79/30 11} Qb7+ {(Qb7+) 0.00/34 6} 134. Bb6 {(Bb6 Qe7+ Bc5 Qb7+ Ka5 Qa8+ Ba7 Qb7 h5 Qe7 Qe3 Qd8+ Kb4 Qd6+ Bc5 Qb8+ Ka5 Qa8+ Kb5 Qb7+ Ka5 Qa8+) 0.79/29 9} Qe7+ {(Qe7+ Ka5 Qa3+ Kb5 Qb3+ Kc5 Bg6 Bc7 Qa3+ Kb6 Qb2+ Kc6 Be8+ Kd6 Bg6 Ke6 Qb3+ Ke7 Qf7+ Kd6 Qf3 Ke6 Qf7+ Kd6) 0.00/35 8} 135. Bc5 {(Bc5 Qb7+ Ka5 Qa8+ Ba7 Qb7 c4 Qb3 Bc5 Qa4+ Kb6 Qb3+ Ka7 Bd3 Bf8 Qa4+ Kb6) 0.84/28 3} Qb7+ {(Qb7+ Ka5 Qa8+ Kb6 Qb8+ Kc6 Qc8+ Kd6 Qb8+ Kc6) 0.00/36 9} 136. Ka5 {(Ka5 Qa8+ Ba7 Qf8 Kb6 Qe8 c4 Qa4 Kb7 Bg6 Bb6 Bf7 Qd3+ Bg6 Qd5 Qb3 Kc6 Qa2 Kd6 Qa4) 0.78/31 13} Qa8+ {(Qa8+) 0.00/36 5} 137. Ba7 {(Ba7 Qf8 Kb6 Qe8 c4 Qa4 Kb7 Bg6 Bb6 Bf7 Qd3+ Bg6 Qd5 Qe8 Kc7 Be4 Qd7 Qa8 c5) 0.79/31 11} Bg6 {(Bg6 Kb4 Qb7+ Bb6 Qe7+ Kc4 Qe2+ Kc5 Qe7+ Kc4) 0.00/34 6} 138. c4 {(c4 Be8 Qe3 Qd8+ Kb4 Qd7 Qe4+ Bg6 Qd4 Qf5 Bc5 Qb1+ Ka3 Qc1+ Kb4 Qb1+) 0.79/31 10} Be8 {(Be8) 0.00/35 5} 139. Qe3 {(Qe3 Qd8+ Kb4 Qd7 Qe4+ Bg6 Qd4 Qf5 Bc5 Qb1+ Ka3 Qc1+ Kb3 Qb1+ Qb2 Qe4 Qc3 Bf7 Qd4 Qb1+ Ka4 Be8+ Ka5 Qa2+ Kb6) 0.79/32 9} Bg6 {(Bg6 Kb4 Qb7+ Ka5 Qa8) 0.00/34 6} 140. Kb4 {(Kb4 Qb7+ Bb6 Qb8 Qc5 Qh2 Qf2 Qd6+ Bc5 Qb8+ Kc3 Qa8 Kb3 Qb7+ Bb4 Qe4 Ba3 Qd3+ Kb4) 0.99/27 9} Qb7+ {(Qb7+ Ka5 Qa8 Kb4 Qb7+) 0.00/35 7} 141. Bb6 {(Bb6 Qb8 Qc5 Qb7 Qd6 Qa6 Qd4 Be8 Ba5 Qc6 Qd3+ Kh8 Qd1 Qe4 Qd5 Qxh4 Qd3) 0.85/28 9} Bf7 {(Bf7 Qd3+ Bg6 Qe3 Bf7) 0.00/35 9} 142. Qd3+ {(Qd3+ Bg6 Qd8 Bh5 Kb5 Bf7 Qd3+ Kg8 Ka5 Qc6 g6 Bxg6 Qd5+ Qxd5+ cxd5 Kf7 Kb5 Be4 Kc6 Ke8 Bd4 g6 Be3 Bg2 Bg5) 0.86/28 8} Bg6 {(Bg6 Qe3 Bf7 Qd3+ Bg6) 0.00/39 6} 143. Qd8 {(Qd8 Bh5 Kb5 Bf7 Qd3+ Kg8 Qd4 Qh1 Bc5 Be8+ Kb4 Qb1+ Kc3 Qc1+ Kb3 Qb1+ Qb2 Qe4 Bb6 Bf7 Qd4 Qb1+ Ka4 Qa2+ Kb5) 0.78/28 8} Bh5 {(Bh5 Kc5 Bg6 Kb4 Bh5) 0.00/36 9} 144. Kb5 {(Kb5 Qf3 Ba5 Qb7+ Kc5 Qa7+ Kb4 Qe3 Kb5 Be8+ Ka6 Bf7 Qc8 Qd3 Kb5 Qb1+) 0.78/28 7} Bf7 {(Bf7 Qd4 Qa8 Bc5 Be8+ Kb6 Qc6+ Ka7 Qc7+ Ka6 Qc6+ Ka5 Qa4+ Kb6 Qc6+) 0.00/33 7} 145. Qc7 {(Qc7 Be8+ Ka5 Qe4 Bf2 Qf5+ Bc5 Bf7 Kb5) 0.73/28 7} Be8+ {(Be8+ Kc5 Qe4 Kd6 Qxh4 c5 Qxg5 Qe7 Qxe7+ Kxe7) 0.00/35 7} 146. Ka5 {(Ka5 Qe4 Bf2 Qf5+ Qc5 Qc2 Bd4 Bf7 h5 Qa2+ Kb6 Qb3+ Kc7 Bxh5 Qd5 Qa4 Qe4+ Kh8 c5 Qa5+ Kb8 Qd8+ Kb7 Qd7+ Kb6) 0.77/30 8} Qe4 {(Qe4 Qd8 Bf7 Qd4 Qe1+ Kb5 Qe8+ Kb4 Qe1+ Kb5) 0.00/34 6} 147. Bf2 {(Bf2 Qf5+ Qc5 Qb1 Bd4 Qe1+ Qb4 Qxh4 Bf6 Qe4 Qe7 Qa8+ Kb4 Qb8+ Ka3 Qg3+ Kb2 Qb8+ Kc2 Bf7 Qxf7 Qb3+ Kxb3 Kh8) 0.62/30 4} Qd3 {(Qd3 Qe5 Qxc4 Qxe8 Qa2+ Kb4 Qxf2 g6+ Kh6 Qh8+ Kxg6) 0.00/35 7} 148. Bg3 {(Bg3 Qa3+ Kb6 Qb4+ Ka6 Qa4+ Kb7 Bg6 Bd6 Bd3 Bf8 Qb3+ Ka7 Qa2+ Kb6 Qf2+ Qc5 Qb2+ Ka5 Qa2+ Kb5 Qb3+ Qb4 Bxc4+ Kc5) 0.48/29 8} Qa3+ {(Qa3+ Kb6 Qb4+ Ka7 Qa4+ Kb8 Qb4+ Kc8 Qa4 h5 Bxh5 c5 Qa8+ Qb8 Qc6+ Qc7 Qa8+) 0.00/32 6} 149. Kb6 {(Bg3 Qa3+ Kb6 Qb4+ Ka6 Qa4+ Kb7 Bg6 Bd6 Bd3 Bf8 Qb3+ Ka7 Qa2+ Kb6 Qf2+ Qc5 Qb2+ Ka5 Qa2+ Kb5 Qb3+ Qb4 Bxc4+ Kc5) 0.48/29 1} Qb4+ {(Qb4+) 0.00/35 9} 150. Ka6 {(Ka6 Qa4+ Kb7 Bg6 Bd6 Qb3+ Ka7 Qa2+ Kb8 Qb3+ Kc8 Bd3 Kd8 Bxc4 Be5 Bf7 Qc5 Qb7 Bd4 Bh5 Qc2+ Kg8) 0.17/30 9} Bg6 {(Bg6 Ka7 Qa3+ Kb8 Qb4+ Ka7) 0.00/34 8} 151. Bd6 {(Bd6 Qa4+ Kb7 Qb3+ Kc8 Bd3 Be5 Qxc4 Qxc4 Bxc4 Kd8 Kg6 Ke7 Kh5 Bxg7 Kxh4 Kf6 Bd3 Bf8 Kh5 Bb4) 0.21/30 6} Qa4+ {(Qa4+ Kb6 Qb3+ Ka7 Qa4+ Kb7 Be4+ Kb6 Qb3+ Ka7 Qa4+ Kb6) 0.00/33 6} 152. Kb7 {(Kb7 Qb3+ Ka7 Qa4+ Kb6 Qb3+ Kc5 Qa3+ Kd5 Qf3+ Kd4 Qf2+ Kd5 Bf7+ Ke4 Qxh4+ Bf4 Qh1+ Kf5 Kg8 Qd8+ Kh7 Qe7 Bxc4 g6+) 0.17/32 9} Qb3+ {(Qb3+) 0.00/36 8} 153. Kc8 {(Kc8 Bd3 Be5 Qxc4 Qxc4 Bxc4 Kd8 Kg6 Ke7 Kh5 Bxg7 Kxh4 Kf6 Bd3 Bf8 Kh5 Bb4 Be4 Bd2 Kg4) 0.17/32 9} Bd3 {(Bd3 Be5 Qxc4 Qxc4 Bxc4 Kc7 Kg6 Kd6 Kh5 Bxg7) 0.00/39 8} 154. Be5 {(Be5 Qxc4 Qxc4 Bxc4 Kd8 Bb5 Ke7 Kg8 Ke6 Be2 Bd4 Bg4+ Ke7 Bh5 Bf2 Be2 Bb6 Bb5 Bd4 Bc4 Be5 Bd3 Bd4 Bc4) 0.17/34 12} Qxc4 {(Qxc4 Qxc4 Bxc4 Kc7 Kg6 Kd6 Kh5 Bxg7) 0.00/51 15} 155. Qxc4 {(Qxc4 Bxc4 Kd8 Bb5 Ke7 Kg8 Ke6 Be2 Bd4 Bg4+ Ke7 Bh5 Bf2 Be2 Bb6 Bb5 Bd4 Bc4 Be5 Bd3 Bd4 Bc4) 0.17/41 8} Bxc4 {(Bxc4 Kc7 Kg6 Kd6 Kh5 Bxg7) 0.00/59 5} 156. Kd8 {(Kd8 Bb5 Ke7 Kg8 Ke6 Be2 Bd4 Bg4+ Ke7 Bh5 Bf2 Be2 Bb6 Bb5 Bd4 Bc4 Be5 Bd3 Bd6 Be2 Bb4 Bd1 Bc5 Bh5 Bf2) 0.17/66 8} Be6 {(Be6 h5 Bg4 Ke7 Bxh5) 0.00/64 11} 157. Ke7 {(Ke7 Bb3 Kf8 Kg6 Bg3 Bc2 Bd6 Kh5 Kxg7 Kxh4 Kh6 Kg4 Bb4 Kf5 Bd2 Ke6 Kg7 Kf5 Be3 Be4 Bc1 Kg4 Kh6 Kf5 Bb2) 0.29/38 8} Bh3 {(Bh3 g6+ Kxg6) 0.00/59 7} 158. Kf7 {(Kf7 g6 h5 Bf5 h6 Be4 Ke6 Bd3 Kd6 Be2 Bf6 Bd3 Kc5 Be4 Kc4 Bc2 Kb4 Bb1 Kb3 Kg8 Ka4 Kh7 Kb4 Bf5 Kb3) 0.80/65 11} Bg4 {(Bg4) 0.00/67 7} 159. Bxg7 {(Bxg7 Bh5+ Kf6 Bf7 Bf8 Bh5 Bd6 Be2 Be5 Bh5 Bg3 Bg6 Bh2 Bd3 Bf4 Bg6 Bh2) 1.15/45 10} Bh5+ {(Bg4 Bxg7) 0.00/67 1} 160. Kf6 {(Kf6 Bf7 Bf8 Bh5 Bd6 Be2 Be5 Bh5 Bg3 Bg6 Bh2 Bd3 Bf4 Bg6 Bh2) 1.15/67 10} Bf7 {(Book)} 161. Bf8 {(Bf8 Bh5 Bd6 Be2 Be5 Bh5 Bg3 Bg6 Bh2 Bd3 Bf4 Bg6 Bh2) 1.15/70 11} Bg6 {(Book)} 162. Be7 {(Be7 Bh5 Bd6 Be2 Be5 Bh5 Bg3 Bg6 Bh2 Bd3 Bf4 Bg6 Bh2) 1.15/73 9} Bd3 {(Book)} 163. Bc5 {(Bc5 Bg6 Be3 Bh5 Bf4 Bd1 g6+ Kg8 Kg5 Be2) 1.15/71 8} Be2 {(Book)} 164. Be3 {(Be3 Bh5 Bf4 Be8 Bc7 Bg6 Bd8 Bh5 Bb6 Bg6 Ba5 Be4 Bb4 Bd3 Be1 Be2 Bc3 Bd3 Bd2 Bg6 Bb4 Be4 Bc3 Bd3) 1.15/76 8} Bh5 {(Book)} 165. Bf4 {(Bf4 Be8 Bc7 Bg6 Bd8 Bh5 Bb6 Bg6 Ba5 Be4 Bb4 Bd3 Be1 Be2 Bc3 Bd3 Bd2 Bg6 Bb4 Be4 Bc3 Bd3) 1.15/78 9} Bg6 {(Book)} 166. Bh2 {(Bh2 Bd3 Be5 Bg6 Bc3 Bc2 Bd2 Bg6 Bb4 Be4 Bc3 Bd3 Bd2 Bg6) 1.15/73 4} Bd3 {(Book)} 167. Be5 {(Be5 Bg6 Bc3 Bc2 Bd2 Bg6 Bb4 Bh5 Bd6 Be2 Be5 Bh5 Bg3 Bg6 Bh2 Bd3) 1.15/75 5} Be2 {(Book)} 168. Ba1 {(Ba1 Bh5 Bd4 Bg6 Bg1 Bh5 Bf2 Bd1 Be1 Bh5 Bb4 Bd1 Bc3 Bf3 Bd2 Bh5 g6+ Bxg6 Bf4) 1.15/79 12} Bh5 {(Book)} 169. Bd4 {(Bd4 Bg6 Bg1 Bh5 Bf2 Bd1 Be1 Bh5 Bb4 Bd1 Bc3 Bf3 Bd2 Bh5 g6+ Bxg6 Bf4) 1.15/79 5} Bf7 {(Book)} 170. Bc3 {(Bc3 Bh5 Ba5 Bg6 Be1 Bd3 Bc3 Be4 Ba5 Bf3 g6+ Kh6 g7 Bd5 g8=N+ Bxg8 Bb6) 1.15/78 12} Bg6 {(Book)} 171. Ba5 {(Ba5 Be4 Bb4 Bd3 Be1 Be2 Bc3 Bd3 Bd2 Bg6 Bc1 Bh5 Ba3 Bf3 h5 Bxh5 g6+ Bxg6 Be7) 1.15/81 7} Bd3 {(Book)} 172. Bd2 {(Bd2 Bg6 Bc1 Bh5 Ba3 Bf3 h5 Bxh5 g6+ Bxg6 Be7) 1.15/76 4} Bg6 {(Book)} 173. Bc1 {(Bc1 Bh5 Ba3 Bf3 Bf8 Bh5 Bd6 Be2 Be5 Bh5 Bg3 Bg6 Bh2 Bd3 g6+ Bxg6 Bd6) 1.15/81 9} Bh5 {(Book)} 174. Ba3 {(Ba3 Bf3 Bf8 Bh5 Bd6 Be2 Be5 Bh5 Bg3 Bg6 Bd6 Bd3 Bh2 Be2 Bg3 Bh5 Be1 Bg6 Bc3 Bc2 Bd2 Bg6 Bc1 Bh5) 1.15/84 8} Be2 {(Book)} 175. Bf8 {(Bf8 Kg8 g6 Kxf8 h5) 1.15/82 12} Kg8 {(Book)} 176. Bd6 {(Bd6 Kh7 Be5 Bh5 Bg3 Bg6 Bd6 Bd3 Be5 Bg6 Bc3 Bc2 Bd2 Bg6 Bc1 Bh5 Ba3 Bf3 Bf8 Bh5 Bd6 Be2) 1.15/81 10} Kh7 {(Book)} 177. Be5 {(Be5 Bh5 Bg3 Bg6 Be1 Bd3 Bb4 Bc2 Bc5 Be4 h5 Bf3 g6+ Kh6 Bf8+ Kxh5 g7 Bd5 g8=B Bxg8 Bd6) 1.09/80 9} Bd3 {(Book)} 178. Ba1 {(Ba1 Be2 Bb2 Bd3 Ba3 Bc2 Bc1 Bg6 Bd2 Bh5 g6+ Bxg6 Bf4) 1.15/76 5} Bf1 {(Book)} 179. Bd4 {(Bd4 Be2 Ba7 Bh5 Be3 Bg6 Bg1 Bh5 Bf2 Bd1 g6+ Kh6 Be1 Be2 Ba5 Kh5 g7 Bc4 g8=B Bxg8 Ke5) 1.15/83 7} Bd3 {(Book)} 180. Bf2 {(Bf2 Be4 Be3 Bg6 Bg1 Bh5 Bf2 Bd1 g6+ Kh6 Be1 Be2 Ba5 Kh5 g7 Bc4 g8=B Bxg8 Ke5) 1.15/80 9} Be2 {(Book)} 181. Ba7 {(Ba7 Bh5 Be3 Bg6 Bg1 Bh5 Bf2 Bd1 g6+ Kh6 Be1 Be2 Ba5 Kh5 g7 Bc4 g8=B Bxg8 Ke5) 1.15/84 11} Bd3 {(Book)} 182. Be3 {(Be3 Bg6 Bg1 Bh5 Bf2 Bd1 g6+ Kh6 Be1 Be2 Ba5 Kh5 g7 Bc4 g8=B Bxg8 Ke5) 1.15/81 10} Bg6 {(Book)} 183. Bg1 {(Bg1 Bh5 Bf2 Bd1 g6+ Kh6 Be1 Be2 Ba5 Kh5 g7 Bc4 g8=B Bxg8 Ke5) 1.15/78 9} Bd3 {(Book)} 184. Bh2 {(Bh2 Be2 Bg3 Bh5 Bb8 Bg6 Bf4 Be8 Bc7 Bg6 Bd8 Bh5 Bc7 Be2 Bb6 Bf3 Bd4 Bd1 Bb2 Bh5 Bc1 Bg6 Bd2 Bh5 g6+) 1.15/83 8} Be2 {(Book)} 185. Bg3 {(Bg3 Bh5 Bb8 Bg6 Bf4 Be8 Bd6 Bg6 Ba3 Bd3 Be7 Be2 Bd8 Bh5 Bc7 Be2 Bb6 Bf3 Bd4 Bd1 Bb2 Bh5 Bc1 Bg6 Bd2) 1.15/82 8} Bd3 {(Book)} 186. Be1 {(Be1 Be2 Bf2 Bh5 Ba7 Bg6 Bf2 Bc2 Bb6 Bd3 Be3 Bg6 Bg1 Bh5 Bf2 Bd1 g6+ Kh6 Be1 Be2 Ba5 Kh5 g7 Bc4 g8=B) 1.15/77 5} Be2 {(Book)} 187. Bc3 {(Bf2 Bh5 g6+ Bxg6 Bc5) 1.15/79 10} Bd3 {(Book)} 188. Bd4 {(Bd4 Bc2 Bb6 Bd3 Be3 Bg6 Bg1 Bh5 Bf2 Bd1 g6+ Kh6 Be1 Be2 Ba5 Kh5 g7 Bc4 g8=B Bxg8 Ke5) 1.15/80 6} Be2 {(Book)} 189. Ba7 {(Ba7) 1.15/70 6} Bd3 {(Book)} 190. Bb8 {(Bg1 Bg6 Bf2 Bh5 Bb6 Bf3 Bd4 Bd1 Bb2 Bh5 Bc1 Bg6 Bd2 Bh5 g6+ Bxg6 Bf4) 1.14/73 11} Be2 {(Book)} 191. Bf4 {(Bf4 Bh5 Bc1 Bg6 Bd2 Bh5 Ba5 Bg6 Be1 Bd3 Bc3 Be4 h5 Bf3 h6 Be4 g6+ Bxg6 Bd2) 1.15/75 10} Bh5 {(Book)} 192. Bd6 {(Bd6 Be2 Be5 Bh5 Bg3 Bg6 Be1 Bd3 Bc3 Be4 h5 Bf3 h6 Be4 g6+ Bxg6 Bd2) 1.15/81 9} Be2 {(Book)} 193. Bb8 {(Bb8 Bd1 Kf7 Bb3+ Kf6 Bd1) 1.15/75 9} Bd3 {(Book)} 194. Bg3 {(Bg3 Be2 Bb8 Bd1 Kf7 Bb3+ Ke7 Kg6 Be5 Bd1 Kd6 Kh5 Bb2) 1.15/76 8} Be2 {(Book)} 195. Bc7 {(Bc7 Bd3 Bh2 Be2 Bg3 Bc4 Bf4 Kg8 Kg6 Bd3+) 1.14/49 9} Bd3 {(Book)} 196. Ba5 {(Ba5 Be2 Bb4 Bd1 Bc3 Bf3 Bd2 Bh5 Ba5 Bg6 Be1 Bd3 Bc3 Be4 h5 Bf3 h6 Be4 g6+ Bxg6 Bd2) 1.15/71 7} Be2 {(Book)} 197. Bb4 {(Bb4 Bd1 Bc3 Bf3 Bd2 Bh5 Ba5 Bg6 Be1 Bd3 Bc3 Be4 h5 Bf3 h6 Be4 g6+ Bxg6 Bd2) 1.15/70 9} Bd3 {(Book)} 198. Bc3 {(Bc3 Be4 h5 Bf3 h6 Be4 g6+ Bxg6 Bd2) 1.15/72 9} Be2 {(Book)} 199. Bb2 {(Bb2 Bd3 Ba3 Bc2 Bc1 Bg6 Bd2 Bh5 Ba5 Bg6 Be1 Bd3 Bc3 Be4 h5 Bf3 h6 Be4 g6+ Bxg6 Bd2) 1.15/67 9} Bd3 {(Book)} 200. Ba3 {(Ba3 Bc2 Bc1 Bg6 Bd2 Bh5 Ba5 Bg6 Be1 Bd3 Bc3 Be4 h5 Bf3 h6 Be4 g6+ Bxg6 Bd2) 1.09/66 8} Be2 {(Book)} 201. Bc5 {(Bc5 Bh5 Bb6 Bf3 Bd4 Bd1 Bb2 Bc2 Ba3 Bd3 Be7 Bc2 Bf8 Kg8 Be7 Kh7) 1.15/76 8} Bd3 {(Book)} 202. Bg1 {(Bg1 Bg6 Bf2 Bh5 Bb6 Bf3 Bd4 Bd1 Bb2 Bc2 Ba3 Bd3 Be7 Bc2 Bf8 Kg8 Be7 Kh7) 1.14/69 8} Be2 {(Book)} 203. Bb6 {(Bb6 Bf3 Bd4 Bd1 Bb2 Bc2 Ba3 Bd3 Be7 Bc2 Bf8 Kg8 Be7 Kh7) 1.12/62 8} Bd3 {(Book)} 204. Ba7 {(Ba7 Be2 Bf2 Bh5 Bb6 Bf3 Bd4 Bd1 Bb2 Bc2 Ba3 Bd3 Be7 Bc2 Bf8 Kg8 Be7 Kh7) 1.12/56 8} Be2 {(Book)} 205. Bf2 {(Bf2 Bh5 Bb6 Bf3 Bd4 Bd1 Bb2 Bc2 Ba3 Bd3 Be7 Bc2 Bf8 Kg8 Be7 Kh7) 1.12/58 8} Bd3 {(Book)} 206. h5 {(h5 Be2 h6 Bd3 Bg3 Bc2 Be5 Bd1 Ke7 Bc2 Kf8 Kg6 Bf6 Bd3 Ke7 Be4 Kd6 Kf7 Kc5 Bc2 Kd5 Bb1 Kd6 Bd3 Be5) 0.81/45 8} Be2 {(Book)} 207. h6 {(h6 Bd3 Bg3 Bc2 Be5 Bd1 Ke7 Bc2 Kf8 Kg6 Bf6 Bd3 Ke7 Be4 Kd6 Kf7 Kc5 Bc2 Kd5 Bb1 Kc4 Kg6 Kc3 Kf7 Kd4) 0.81/47 7} Bh5 {(Book)} 208. Be3 {(Be3 Bg6 Bf4 Bd3 Ke5 Bb1 Kd4 Kg6 Kc5 Be4 Kb4 Bb1 Kb5 Bd3+ Kc6 Be4+ Kc5 Bb1 Kd5 Bd3 Bc1 Kf7 Bb2 Bc2 Kd6) 0.81/52 9} Bg6 {(Book)} 209. Bf4 {(Bf4 Bd3 Ke5 Bb1 Kd4 Kg6 Kc5 Be4 Kb4 Bb1 Kb5 Bd3+ Kc6 Be4+ Kc5 Bb1 Kd5 Bd3 Bc1 Kf7 Bb2 Bc2 Kd6 Be4 Be5) 0.81/53 6} Bh5 {(Book)} 210. Bd2 {(Bd2 Bg6 Ke5 Kg8 Kd5 Kf7 Bf4 Bc2 Be5 Kg6 Bf6 Kf7 Kc4 Bh7 Kb5 Bc2 Kb4 Kg6 Kc3 Bb1 Kb2 Bf5 Kb3 Kf7 Kb4) 0.81/64 9} Bg6 {(Book)} 211. Ke5 {(Ke5 Kg8 Kd5 Kf7 Bf4 Bc2 Be5 Kg6 Bf6 Kf7 Kc4 Bh7 Kb5 Bc2 Kb4 Kg6 Kc3 Bb1 Kb2 Bf5 Kb3 Kf7 Kb4 Kg6 Ka4) 0.81/64 9} Bf7 {(Book)} 212. Be3 {(Be3 Ba2 Kd6 Kg6 Bd4 Bf7 Bf6 Bc4 Kc5 Bb3 Kb5 Bc2 Kc6 Bf5 Be7 Kf7 Bd8 Kg6 Kd5 Kf7 Kc5 Bc2 Kd4 Bb1 Kc5) 0.81/64 8} Ba2 {(Book)} 213. Kd6 {(Kd6 Kg6 Bd4 Bf7 Bf6 Bc4 Kc5 Bb3 Kb5 Bc2 Kc6 Bf5 Be7 Kf7 Bd8 Kg6 Kd5 Kf7 Kc5 Bc2 Kd4 Bb1 Kc5 Bd3 Kb4) 0.81/68 9} Bf7 {(Book)} 214. Bc1 {(Bc1 Bh5 Bb2 Kg6 Bf6 Bd1 Kc7 Bf3 Kb8 Be4 Kc7 Bf5 Bd8 Bb1 Kb6 Bf5 Kc5 Kf7 Kd5 Bd3 Bf6 Bc2 Kc4 Bh7 Kb5) 0.81/64 8} Bh5 {(Book)} 215. Bb2 {(Bb2 Kg6 Bf6 Bd1 Kc7 Bf3 Kb8 Be4 Ka7 Bf5 Kb6 Bd3 Be7 Kf7 Bd8 Bc2 Bf6 Bd3 Kc5 Bc2 Kd4 Bb1 Ke3 Kg6 Be7) 0.81/64 8} Kg8 {(Book)} 216. Bf6 {(Bf6 Bg6 Kd7 Kf7 Kc7 Bc2 Kb8 Bd3 Be5 Bc2 Ka8 Bd3 Bf4 Bc2 Bd2 Be4+ Kb8 Kg6 Bc1 Bd3 Kb7 Kf7 Bf4 Bc2 Ka6) 0.81/49 8} Bf7 {(Book)} 217. Be5 {(Be5 Kh7 Kc5 Bg8 Bf4 Bb3 Kb5 Bc2 Ka6 Bb1 Kb6 Bf5 Bc1 Bd3 Ka5 Kg6 Kb4 Ba6 Bd2 Be2 Ka4 Bd3 Kb3 Kf7 Kc3) 0.81/54 8} Bg6 {(Book)} 218. Bf4 {(Bf4 Kf7 Bc1 Bh7 Ke5 Bg6 Kf4 Bb1 Bb2 Kg6 Kg4 Bf5+ Kh4 Kf7 Bf6 Kg6 Kg3 Bb1 Kf4 Kf7 Be5 Kg6 Bb2 Bd3 Bf6) 0.81/65 8} Bd3 {(Book)} 219. Kc5 {(Kc5 Kf7 Kb6 Kg6 Kb7 Kf7 Ka8 Bc2 Bd2 Be4+ Kb8 Kg6 Bc1 Kf7 Kc7 Kg6 Kd8 Kf7 Bf4 Bc2 Kc7 Kg6 Kc6 Bd3 Kd5) 0.81/58 8} Be4 {(Book)} 220. Kb4 {(Kb4 Kh7 Be5 Bc2 Kc3 Bb1 Kb2 Bf5 Kc1 Kg6 Bf4 Kf7 Be3 Bg6) 0.81/56 7} Bd3 {(Book)} 221. Kb3 {(Kb3 Bf5 Kc4 Kf7 Be5 Kg6 Bf6 Kf7 Kb5 Be4 Kb4 Bh7 Kc5 Bb1 Be5 Kg6 Bf4 Be4 Kb4 Bb1 Kb5 Bd3+ Kc6 Be4+ Kc5) 0.81/62 9} Kh7 {(Book)} 222. Be3 {(Be3 Bb1 Ka4 Bc2+ Kb4 Bb1 Bd4 Kg6 Bf6 Kf7 Kc5 Bc2 Kd4 Bb1 Ke3 Kg6 Be7 Kf7 Bd8 Kg6 Ke2 Kf7 Bf6 Bh7 Kf1) 0.81/65 8} Bb5 {(Book)} 223. Bc1 {(Bc1 Bd3 Ba3 Bb1 Be7 Kg6 Bd8 Kf7 Kb2 Bh7 Bf6 Kg6 Be7 Kf7 Bb4 Kg6 Bd2 Kh5 Bc1 Kg6 Kc3 Kf7 Kb4 Be4 Bb2) 0.81/66 9} Bd7 {(Book)} 224. Kb4 {(Kb4 Bf5 Ka5 Bd3 Kb6 Bc2 Kb5 Kg6 Kc6 Kf7 Kd7 Bb1 Kd8 Bc2 Bd2 Bd3 Bf4 Kg6 Kc7 Kf7 Be5 Kg6 Bf6 Kf7 Kd7) 0.81/61 6} Bc8 {(Book)} 225. Be3 {(Be3 Bf5 Ka4 Bb1 Bf4 Kg6 Bc1 Kf7 Kb5 Kg6 Bf4 Bd3+ Kc6 Be4+ Kc5 Bb1 Kd5 Bd3 Bc1 Kf7 Bb2 Bc2 Kd6 Be4 Be5) 0.81/57 10} Bb7 {(Book)} 226. Ka4 {(Ka4 Be4 Bc1 Kg6 Kb5 Kf7 Bf4 Bd3+ Kc6 Bb1 Kd5 Kg6 Kd4 Bf5 Bd2 Bb1 Bc1 Kf7 Kd5 Kg6 Ke6 Be4 Ke7 Bc2 Kf8) 0.81/60 9} Ba6 {(Book)} 227. Bf4 {(Bf4 Bd3 Bc1 Kg6 Kb3 Kf7 Bb2 Bh7 Be5 Kg6 Bf4 Kf7 Bd2 Bg6 Ka2 Be4 Bf4 Bh7 Ka3 Bb1 Bd2 Bg6 Ka4 Bc2+ Kb5) 0.81/68 9} Bf1 {(Book)} 228. Bd2 {(Bd2 Bd3 Bc1 Kg6 Kb3 Kf7 Bb2 Bh7 Be5 Kg6 Bf4 Kf7 Bd2 Bg6 Ka2 Be4 Bf4 Bh7 Ka3 Bb1 Bd2 Bg6 Ka4 Bc2+ Kb5) 0.81/68 8} Be2 {(Book)} 229. Bc1 {(Bc1 Bh5 Ka5 Bd1 Ka6 Be2+ Kb6 Bd1 Bd2 Bc2 Kb7 Bd3 Kc6 Kg6 Kc5 Kf7 Bc3 Bc2 Kd6 Bd3 Kc6 Kg6 Bf6 Kf7 Bb2) 0.81/57 8} Bd1+ {(Book)} 230. Kb4 {(Kb4 Bc2 Bf4 Bd3 Kb3 Kg6 Kc3 Be4 Kd2 Bb1 Ke1 Be4 Kf2 Bb1 Bc1 Kf7 Be3 Bg6 Ke2 Bh5+ Kf1 Bg6 Bf4 Bb1 Kg1) 0.81/58 8} Bg4 {(Book)} 231. Bf4 {(Bf4 Bd1 Be5 Kg6 Kb5 Bc2 Bf6 Kf7 Kb4 Kg6 Kc3 Bb1 Kb2 Bf5 Kb3 Kf7 Kb4 Kg6 Ka4 Kf7 Ka3 Bh7 Kb3 Bb1 Kb2) 0.81/57 6} Bh5 {(Book)} 232. Ka3 {(Ka3 Bg6 Ka4 Bc2+ Kb5 Kg6 Bd2 Kf7 Ka6 Kg6 Bc1 Bb1 Ka7 Kf7 Be3 Bd3 Bf4 Bc2 Bc1 Bb1) 0.81/59 9} Bg4 {(Book)} 233. Be5 {(Be5 Kg6 Bf6 Be2 Kb3 Bd1+ Kc3 Bf3 Kd4 Kh7 Be7 Be2 Ke3 Bc4 Bf8 Bg8 Kd4 Kg6 Be7 Bb3 Kc3 Bg8 Bf6 Kf7 Kb4) 0.81/60 9} Bh5 {(Book)} 234. Bf6 {(Bf6 Bd1 Ka2 Kg6 Kb2 Kh7 Bc3 Kg6 Kc1 Bf3 Bf6 Be4 Kb2 Kf7 Ka1 Bf5 Ka2 Bc2 Be5 Kg6 Kb2 Bf5 Bf6 Kf7 Kb3) 0.81/59 9} Kg8 {(Book)} 235. Kb4 {(Kb4 Bg6 Ka4 Kf7 Ka5 Bd3 Kb4 Bf5 Be5 Kg6 Bf4 Bb1 Kb5 Bd3+ Kc6 Be4+ Kc5 Bb1 Kd5 Bd3 Bc1 Kf7 Bb2 Bc2 Kd6) 0.81/51 7} Bf7 {(Book)} 236. Kc3 {(Kc3 Bg6 Be5 Bh7 Kd4 Kf7 Kc3 Bb1 Kb2 Bh7 Ka1 Bd3 Bf6 Bh7 Be7 Kxe7 Ka2) 0.81/62 9} Bg6 {(Book)} 237. Be5 {(Be5 Bh7 Kd4 Kf7 Kc3 Bb1 Kb2 Bh7 Ka1 Bd3 Bf6 Bc2 Ka2 Bh7 Be5 Kg6 Kb3 Kxg5 Kb2) 0.75/46 4} Bh5 {(Book)} 238. Kb4 {(Kb4 Kh7 Ka4 Kg6 Bf6 Kh7 Kb5 Bg6 Kb6 Bd3 Ka7 Bb1 Ka8 Kg6 Kb7 Kf7 Be5 Kg6 Bf4 Kf5 h7 Kxf4 h8=Q Be4+ Ka6) 0.81/58 9} Bf7 {(Book)} 239. Kb5 {(Kb5 Kh7 Ka6 Kg6 Bf4 Be8 Ka5 Bf7 Kb4 Ba2 Kb5 Bb1 Kc5 Be4 Kb4 Bb1 Kb5 Bd3+ Kc6 Be4+ Kc5 Bb1 Kd5 Bd3 Bc1) 0.81/54 11} Bg6 {(Book)} 240. Bf4 {(Bf4 Bd3+ Kb4 Kf7 Ka4 Kg6 Ka3 Bf5 Kb2 Bd3 Kc3 Be4 Kd2 Bb1 Ke1 Be4 Kf2 Bb1 Bc1 Kf7 Be3 Bg6 Ke2 Bh5+ Kf1) 0.81/56 9} Bd3+ {(Book)} 241. Kb4 {(Kb4 Kf7 Ka4 Kg6 Ka3 Bf5 Kb2 Bd3 Kc3 Be4 Kd2 Bb1 Ke1 Be4 Kf2 Bb1 Bc1 Kf7 Be3 Bg6 Ke2 Bh5+ Kf1 Bg6 Bf4) 0.81/60 9} Be4 {(Book)} 242. Be5 {(Be5 Kf7 Ka4 Bh7 Kb5 Bd3+ Kc5 Kg6 Kd4 Bb1 Bf6 Bc2 Be7 Bb1 Bd8 Kf7 Kc5 Bd3 Kb4 Bf5 Bf6 Kg6 Ka4 Kf7 Ka3) 0.81/63 9} Kh7 {(Book)} 243. Ka4 {(Ka4 Bc2+ Ka5 Bd3 Bf6 Bc2 Kb6 Bb1 Kc5 Be4 Kd6 Kg6 Kc7 Bf5 Bd8 Bb1 Kb6 Bf5 Kc5 Bc2 Kd5 Kf7 Kd4 Bb1 Kc5) 0.81/57 5} Bd5 {(Book)} 244. Bb2 {(Bb2 Kg6 Bf6 Bc6+ Kb4 Be4 Kc4 Bb1 Kc3 Kf7 Kb2 Bh7 Kc1 Bg8 Kd1 Bh7 Ke1 Bb1 Kd1 Bg6 Kd2 Bh7 Be5 Kg6 Bf4) 0.81/62 10} Be4 {(Book)} 245. Bf6 {(Bf6 Bf5 Ka5 Bc2 Kb6 Bb1 Kc5 Be4 Kd6 Bc2 Kc5 Bb1 Kb5 Kg6 Kb4 Kf7 Kc5 Bc2 Kd4 Bb1 Ke3 Kg6 Be7 Kf7 Bd8) 0.81/57 6} Bd5 {(Book)} 246. Kb4 {(Kb4 Bg8 Kc5 Kg6 Kc6 Kf7 Kd6 Bh7 Ke5 Bc2 Kf4 Kg6 Ke3 Bf5 Kf4 Bb1 Be7 Kf7 Bd8 Bh7 Kf3 Bc2 Kg4 Bd3 Kh3) 0.81/61 10} Ba8 {(Book)} 247. Ka5 {(Ka5 Be4 Ka6 Bd3+ Ka5 Bc2 Kb6 Bb1 Kc5 Be4 Kd6 Bc2 Kc5 Bb1 Kb5 Kg6 Kb4 Kf7 Kc5 Bc2 Kd4 Bb1 Ke3 Kg6 Be7) 0.81/58 8} Bc6 {(Book)} 248. Ka6 {(Ka6 Be4 Be5 Bd3+ Ka5 Kg6 Bf6 Kf7 Kb4 Bf5 Be5 Kg6 Bf4 Bb1 Kb5 Bd3+ Kc6 Be4+ Kc5 Bb1 Kd5 Bd3 Bc1 Kf7 Bb2) 0.81/55 10} Bd5 {(Book)} 249. Kb6 {(Kb6 Kg6 Be7 Bg8 Ka6 Bh7 Bf6 Bg8 Ka7 Bc4 Kb8 Bd5 Ka7 Be6 Be7 Kh7 Kb7 Bg8 Kb8 Bf7 Kb7 Kg8 Ka6 Bg6 Bf6) 0.81/58 5} Ba8 {(Book)} 250. Be7 {(Be7 Be4 Ka5 Bf5 Bf6 Bc2 Kb6 Bb1 Kc5 Be4 Kd6 Bc2 Kc5 Bb1 Kb5 Kg6 Kb4 Kf7 Kc5 Bc2 Kd4 Bb1 Ke3 Kg6 Be7) 0.81/59 10} Be4 {(Book)} 251. Ka5 {(Ka5 Bf5 Bf6 Bc2 Kb6 Bb1 Kc5 Be4 Kd6 Bc2 Kc5 Bb1 Kb5 Kg6 Kb4 Kf7 Kc5 Bc2 Kd4 Bb1 Ke3 Kg6 Be7 Kf7 Bd8) 0.81/57 9} Kg8 {(Book)} 252. Bf6 {(Bf6 Bc2 Kb4 Kf7 Kb5 Bb1 Kc5 Bc2 Kd4 Bb1 Ke3 Kg6 Be7 Kf7 Bd8 Kg6 Ke2) 0.81/54 9} Kh7 {(Book)} 253. Ka6 {(Ka6 Bd3+ Ka7 Bb1 Ka8 Kg6 Kb7 Kf7 Bd8 Bh7 Kc7 Kf8 Bf6 Kf7 Kb8 Kg6 Kb7 Kf7 Ka6 Bb1 Kb5 Bc2 Kb4 Kg6 Kc3) 0.81/58 9} Bd3+ {(Book)} 254. Kb6 {(Kb6 Kg6 Kc5 Be4 Kc4 Bb1 Kc3 Kf7 Kb2 Bh7 Kc1 Bg8 Kd1 Bh7 Ke1 Bb1 Kf1 Kg6 Kg2 Kf7 Bd8 Kg6 Kg1 Kf7 Kf1) 0.75/56 8} Bc4 {(Book)} 255. Kc5 {(Kc5 Bb3 Kb5 Bf7 Kc5 Bh5 Kc4 Be2+ Kc5 Bf3 Bd8 Be2 Kb6 Bc4 Bc7 Kg6 Bf4 Bd3 Kb7 Kf7 Ka8 Bc2 Bd2 Be4+ Kb8) 0.81/54 8} Ba2 {(Book)} 256. Kb4 {(Kb4 Bb1 g6+ Bxg6 Kb5) 0.81/54 8} Bf7 {(Book)} 257. g6+ {(g6+ Bxg6 Bg7 Bd3 Kb3 Kg8 h7+ Kxg7 h8=R Kxh8) 0.00/31 8} Kxg6 {(Book)} 1/2-1/2"#;
    let shortened_pgn = r#"[Site "Zangdar Gauntlet"]
[Date "2025.02.16"]
[White "Nalwald 19"]
[Black "Zangdar 3.04"]
[Result "1/2-1/2"]

1. e4 {(Book)} e5 {(Book)} 2. Nf3 {(Book)} Nc6 {(Book)} 3. Bb5 {(Book)} a6 {(Book)} 4. Ba4 {(Book)} d6 {(Book)} 5. c3 {(Book)} f5 {(Book)} 6. exf5 {(Book)} Bxf5 {(Book)} 7. d4 {(Book)} e4 {(Book)} 8. Nfd2 {(Book)} Nf6 {(Book)} 9. f3 {(f3 exf3 O-O Be7 Nxf3 O-O Nbd2 h6 Qb3+ d5 Bxc6 bxc6 Ne5 Qc8 Nxc6 Bd6 Nf3) 0.10/23 10} d5 {(d5) 0.02/32 65} 10. O-O {(O-O Qd7 Qe1 Bd6 fxe4 dxe4 Nc4 b5 Nxd6+ cxd6 Bb3 d5 Qf2 Bg6 Nd2 O-O Bc2) 0.02/23 10} Qd7 {(Qd7) 0.05/33 22} 11. fxe4 {(fxe4 dxe4 Bxc6 bxc6 Nc4 Bd6 Bf4 Bxf4 Rxf4 Nd5 Ne5 Qe6 Rh4 O-O Nd2 e3 Ndf3 c5 Ng5 Qe7 Qe2 Qxg5 dxc5) 0.17/27 24}"#;

        let full_info = get_pgn_info(full_pgn).unwrap();
        let shortened_info = get_pgn_info(shortened_pgn).unwrap();

        assert_eq!(full_info.as_hash(), shortened_info.as_hash());
    }
}
